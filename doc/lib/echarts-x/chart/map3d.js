define("echarts-x/chart/map3d",["require","zrender/tool/util","zrender/config","echarts/util/ecData","echarts/util/mapData/params","echarts/util/mapData/geoCoord","echarts/util/mapData/textFixed","zrender/shape/Polygon","zrender/shape/ShapeBundle","zrender/shape/Text","qtek/Node","qtek/Mesh","qtek/geometry/Sphere","qtek/Material","qtek/Shader","qtek/Texture2D","qtek/math/Vector3","qtek/math/Matrix4","qtek/core/glenum","../config","./base3d","../util/OrbitControl","../surface/ZRenderSurface","../surface/VectorFieldParticleSurface","qtek/core/LRU","echarts/chart"],function(t){function e(t,e,r,i,a){E.call(this,t,e,r,i,a),this.baseLayer.renderer&&(this._earthRadius=100,this._baseTextureSize=2048,this._globeNode=null,this._orbitControl=null,this._mapDataMap={},this._nameMap={},this._globeSurface=null,this._surfaceLayerRoot=null,this._albedoShader=new m({vertex:m.source("ecx.albedo.vertex"),fragment:m.source("ecx.albedo.fragment")}),this._albedoShader.enableTexture("diffuseMap"),this._albedoShaderPA=this._albedoShader.clone(),this._albedoShaderPA.define("fragment","PREMULTIPLIED_ALPHA"),this._sphereGeometry=new f({widthSegments:40,heightSegments:40}),this._imageCache=new R(5),this._vfParticleSurfaceList=[],this.refresh(i))}var r=t("zrender/tool/util"),i=t("zrender/config"),a=t("echarts/util/ecData"),n=t("echarts/util/mapData/params").params,s=t("echarts/util/mapData/geoCoord"),o=t("echarts/util/mapData/textFixed"),u=t("zrender/shape/Polygon"),h=t("zrender/shape/ShapeBundle"),c=t("zrender/shape/Text"),l=t("qtek/Node"),_=t("qtek/Mesh"),f=t("qtek/geometry/Sphere"),d=t("qtek/Material"),m=t("qtek/Shader"),y=t("qtek/Texture2D"),p=t("qtek/math/Vector3"),v=t("qtek/math/Matrix4");t("qtek/core/glenum");var g=t("../config"),E=t("./base3d"),T=t("../util/OrbitControl"),b=t("../surface/ZRenderSurface"),x=t("../surface/VectorFieldParticleSurface"),R=t("qtek/core/LRU"),A=function(t){return[-168.5>t[0]&&t[1]>63.8?t[0]+360:t[0],t[1]]};return e.prototype={type:g.CHART_TYPE_MAP3D,constructor:e,_init:function(){var t=this.component.legend,e=this.series;this.selectedMap={},this.beforeBuildMark();for(var i=0;e.length>i;i++)if(e[i].type===g.CHART_TYPE_MAP3D){e[i]=this.reformOption(e[i]);var a=e[i].name,n=e[i].mapType;this.selectedMap[a]=t?t.isSelected(a):!0,e[i].geoCoord&&r.merge(s,e[i].geoCoord,!0),e[i].textFixed&&r.merge(o,e[i].textFixed,!0),e[i].nameMap&&(this._nameMap[n]=this._nameMap[n]||{},r.merge(this._nameMap[n],e[i].nameMap,!0))}var u=this._groupSeriesByMapType(e),h=this._mergeSeriesData(e);for(var n in h){var c=u[n],l=this.deepQuery(c,"baseLayer.quality");if(isNaN(l))switch(l){case"low":this._baseTextureSize=1024;break;case"high":this._baseTextureSize=4096;break;case"medium":default:this._baseTextureSize=2048}else this._baseTextureSize=l;this._globeNode||(this._createGlob(c),this._initGlobeHandlers()),this._updateGlobe(n,h[n],c),this._setViewport(c);break}var _=this.baseLayer.camera;_.position.y=0,_.position.z=2.5*this._earthRadius,_.lookAt(p.ZERO),this.afterBuildMark()},_setViewport:function(t){var e=this.deepQuery(t,"mapLocation")||{},r=e.x,i=e.y,a=e.width,n=e.height,s=this.zr.getWidth(),o=this.zr.getHeight();r=this.parsePercent(r,s),i=this.parsePercent(i,o),a=this.parsePercent(a,s),n=this.parsePercent(n,o),r=isNaN(r)?0:r,i=isNaN(i)?0:r,a=isNaN(a)?s:a,n=isNaN(n)?o:n,this.baseLayer.setViewport(r,i,a,n)},_groupSeriesByMapType:function(t){for(var e={},r=0;t.length>r;r++)if(t[r].type===g.CHART_TYPE_MAP3D&&this.selectedMap[t[r].name]){var i=t[r].mapType;e[i]=e[i]||[],e[i].push(t[r])}return e},_mergeSeriesData:function(t){for(var e={},r=0;t.length>r;r++)if(t[r].type===g.CHART_TYPE_MAP3D&&this.selectedMap[t[r].name]){var i=t[r].mapType;e[i]=e[i]||{};for(var a=t[r].data||[],n=0;a.length>n;n++){var s=a[n].name||"";e[i][s]=e[i][s]||{seriesIdx:[],value:0},e[i][s].seriesIdx.push(r);for(var o in a[n]){var u=a[n][o];"value"===o?isNaN(u)||(e[i][s].value+=+u):e[i][s][o]=u}}}return e},_updateGlobe:function(t,e,r){var i=this._globeSurface,a=this;i.resize(this._baseTextureSize,this._baseTextureSize);var s=this.deepQuery(r,"baseLayer.backgroundColor"),o=this.deepQuery(r,"baseLayer.backgroundImage");if(i.backgroundColor=this._isValueNone(s)?"":s,this._isValueNone(o))i.backgroundImage=null;else if("string"==typeof o){var u=new Image;u.onload=function(){i.backgroundImage=u,i.refresh()},u.src=o}else i.backgroundImage=o;this._mapDataMap[t]?(this._updateMapPolygonShapes(e,this._mapDataMap[t],r),i.refresh()):n[t].getGeoJson?n[t].getGeoJson(function(n){a._disposed||(a._mapDataMap[t]=n,a._updateMapPolygonShapes(e,n,r),i.refresh())}):i.refresh(),this._surfaceLayerRoot&&this.baseLayer.renderer.disposeNode(this._surfaceLayerRoot,!1,!0),this._surfaceLayerRoot=new l({name:"surfaceLayers"}),this._globeNode.add(this._surfaceLayerRoot);for(var h=0;this._vfParticleSurfaceList.length>h;h++)this._vfParticleSurfaceList[h].dispose();this._vfParticleSurfaceList=[],r.forEach(function(t){var e=this.series.indexOf(t);this.buildMark(e,this._globeNode),this._createSurfaceLayers(e)},this)},_createSurfaceLayers:function(t){for(var e=this.series[t],r=0;e.surfaceLayers.length>r;r++){var i=e.surfaceLayers[r],a=new _({name:"surfaceLayer"+r,geometry:this._sphereGeometry,ignorePicking:!0}),n=i.distance;null==n&&(n=r+1);var s=this._earthRadius+n;switch(a.scale.set(s,s,s),i.type){case"particle":this._createParticleSurfaceLayer(t,i,a);break;case"texture":default:this._createTextureSurfaceLayer(t,i,a)}this._surfaceLayerRoot.add(a)}},_createTextureSurfaceLayer:function(t,e,r){var i=this;r.material=new d({shader:this._albedoShader,transparent:!0,depthMask:!1}),this.series[t];var a=e.image,n=document.createElement("canvas");n.width=1,n.height=1;var s=new y({anisotropic:32,image:n});if(r.material.set("diffuseMap",s),"string"==typeof a){var o=a;a=this._imageCache.get(o),a?s.image=a:(a=new Image,a.onload=function(){s.image=a,s.dirty(),i.zr.refreshNextFrame(),i._imageCache.put(o,a)},a.src=o)}else this._isValueImage(a)&&(s.image=a)},_createParticleSurfaceLayer:function(t,e,r){this.series[t];var i=this.query(e,"particle.vectorField");r.material=new d({shader:this._albedoShaderPA,transparent:!0,depthMask:!1});var a,n=new x(this.baseLayer.renderer,i),s=0,o=0;if(i instanceof Array){if(a=this._createCanvasFromDataMatrix(i),s=a.width,o=a.height,!a)return!1}else{if(!this._isValueImage(i))return!1;s=i.width,o=i.height,a=i}if(s&&o){var u=this.query(e,"size");"number"==typeof u?u=[u,u]:u||(u=[2048,1024]);var h=this.query(e,"particle.sizeScaling")||1,c=this.query(e,"particle.speedScaling");null==c&&(c=1);var l=this.query(e,"particle.color")||"white",_=this.query(e,"particle.number");null==_&&(_=65536);var f=this.query(e,"particle.motionBlurFactor");null==f&&(f=.99),n.vectorFieldTexture=new y({image:a,flipY:!1}),n.surfaceTexture=new y({width:u[0],height:u[1],anisotropic:32}),n.particleSizeScaling=h,n.particleSpeedScaling=c,n.particleColor=this.parseColor(l),n.motionBlurFactor=f;var m=Math.round(Math.sqrt(_));n.init(m,m),n.surfaceMesh=r,this._vfParticleSurfaceList.push(n)}},_createCanvasFromDataMatrix:function(t){var e=t.length;if(!(t[0]instanceof Array))return null;var r=t[0].length;if(!(t[0][0]instanceof Array))return null;var i=document.createElement("canvas");i.width=r,i.height=e;for(var a=i.getContext("2d"),n=a.getImageData(0,0,r,e),s=0,o=0;e>o;o++)for(var u=0;r>u;u++){var h=t[o][u],c=null==h.x?h[0]:h.x,l=null==h.y?h[1]:h.y;n.data[s++]=128*c+128,n.data[s++]=128*l+128,n.data[s++]=0,n.data[s++]=255}return a.putImageData(n,0,0),i},_createGlob:function(t){var e=this.zr;this._globeNode=new l({name:"globe"});var r=new _({name:"earth",geometry:this._sphereGeometry,material:new d({shader:this._albedoShader,transparent:!0})}),i=this._earthRadius;r.scale.set(i,i,i),this._globeNode.add(r);var a=this.baseLayer.scene;a.add(this._globeNode),this._orbitControl=new T(this._globeNode,this.zr,this.baseLayer),this._orbitControl.init(),this._orbitControl.autoRotate=this.deepQuery(t,"autoRotate");var n=new b(this._baseTextureSize,this._baseTextureSize);this._globeSurface=n,r.material.set("diffuseMap",n.getTexture()),n.onrefresh=function(){e.refreshNextFrame()}},_updateMapPolygonShapes:function(t,e,r){function i(t,e){if("Polygon"==t.type)n(t.coordinates,e);else if("MultiPolygon"==t.type)for(var r=0;t.coordinates.length>r;r++)n(t.coordinates[r],e)}function n(t,e){for(var r=0;t.length>r;r++){for(var i=new u({style:{pointList:[]}}),a=0;t[r].length>a;a++){var n=A(t[r][a]),s=(n[0]+180)*o,h=(90-n[1])*l;i.style.pointList.push([s,h])}e.style.shapeList.push(i)}}this._globeSurface.clearElements();for(var s=this.component.dataRange,o=this._baseTextureSize/360,l=this._baseTextureSize/180,_=this.deepQuery(r,"mapType"),f=this._nameMap[_]||{},d=0;e.features.length>d;d++){var m=e.features[d],y=m.properties.name;y=f[y]||y;var p,v=t[y],g=[],E=[];if(v){g.push(v);for(var T=0;v.seriesIdx.length>T;T++){var b=v.seriesIdx[T];E.push(this.series[b].name),g.push(this.series[b])}p=v.value}else v="-",p="-",g=r;E=E.join(" ");var x=this.deepQuery(g,"itemStyle.normal.areaStyle.color");x=s&&!isNaN(p)?s.getColor(p):x;var R=new h({name:y,zlevel:0,cp:m.properties.cp,style:{shapeList:[],brushType:"both",color:x,strokeColor:this.deepQuery(g,"itemStyle.normal.borderColor"),lineWidth:this.deepQuery(g,"itemStyle.normal.borderWidth"),opacity:this.deepQuery(g,"itemStyle.normal.opacity")},highlightStyle:{color:this.deepQuery(g,"itemStyle.emphasis.areaStyle.color"),strokeColor:this.deepQuery(g,"itemStyle.emphasis.borderColor"),lineWidth:this.deepQuery(g,"itemStyle.emphasis.borderWidth"),opacity:this.deepQuery(g,"itemStyle.emphasis.opacity")}});if(a.pack(R,{name:E,tooltip:this.deepQuery(g,"tooltip")},0,v,0,y),"Feature"==m.type)i(m.geometry,R);else if("GeometryCollection"==m.type)for(var T=0;m.geometries>T;T++)i(m.geometries[T],R);this._globeSurface.addElement(R);var S=this._getTextPosition(R),N=(.5-S[1]/this._baseTextureSize)*Math.PI,I=1/Math.cos(N),M=this._baseTextureSize/2048,P=new c({zlevel:1,position:S,scale:[.5*I*M,M],style:{x:0,y:0,brushType:"fill",text:this._getMapLabelText(y,p,g,"normal"),textAlign:"center",color:this.deepQuery(g,"itemStyle.normal.label.textStyle.color"),opacity:this.deepQuery(g,"itemStyle.normal.label.show")?1:0,textFont:this.getFont(this.deepQuery(g,"itemStyle.normal.label.textStyle"))},highlightStyle:{color:this.deepQuery(g,"itemStyle.emphasis.label.textStyle.color"),opacity:this.deepQuery(g,"itemStyle.emphasis.label.show")?1:0,textFont:this.getFont(this.deepQuery(g,"itemStyle.emphasis.label.textStyle"))}});this._globeSurface.addElement(P)}},_getTextPosition:function(t){var e,r=t.name,i=o[r]||[0,0],a=this._baseTextureSize;if(s[r])e=[(s[r][0]+180)/360*a,(90-s[r][1])/180*a];else if(t.cp)e=[(t.cp[0]+i[0]+180)/360*a,(90-(t.cp[1]+i[1]))/180*a];else{var n=t.getRect(t.style);e=[n.x+n.width/2+i[0],n.y+n.height/2+i[1]]}return e},_initGlobeHandlers:function(){var t=this._globeNode.queryNode("earth"),e=function(t){var e=this._globeSurface.hover(t);e&&this.zr.handler.dispatch(t.type,{target:e,event:t.event,type:t.type})},r=["CLICK","DBLCLICK","MOUSEOVER","MOUSEOUT","MOUSEMOVE","DRAGSTART","DRAGEND","DRAGENTER","DRAGOVER","DRAGLEAVE","DROP"];r.forEach(function(r){t.on(i.EVENT[r],e,this)},this)},_eulerToSphere:function(t,e,r){var i=Math.asin(e),a=Math.atan2(r,-t);0>a&&(a=2*Math.PI+a),180*i/Math.PI+90,180*a/Math.PI},_isValueNone:function(t){return null==t||""===t||"string"==typeof t&&"none"==t.toLowerCase()},_isValueImage:function(t){return t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof Image},_getMapLabelText:function(t,e,r,i){var a=this.deepQuery(r,"itemStyle."+i+".label.formatter");return a?"function"==typeof a?a.call(this.myChart,t,e):"string"==typeof a?(a=a.replace("{a}","{a0}").replace("{b}","{b0}"),a=a.replace("{a0}",t).replace("{b0}",e)):void 0:t},getMarkCoord:function(t,e,r){var i=e.geoCoord||s[e.name],a=[],n=this.series[t],o=this.deepQuery([e,n.markPoint||n.markLine||n.markBar],"distance");a[0]=null==i.x?i[0]:i.x,a[1]=null==i.y?i[1]:i.y,a=A(a);var u=a[0],h=a[1];u=Math.PI*u/180,h=Math.PI*h/180;var c=this._earthRadius+o,l=Math.cos(h)*c;r._array[1]=Math.sin(h)*c,r._array[0]=-l*Math.cos(u+Math.PI),r._array[2]=l*Math.sin(u+Math.PI)},getMarkPointTransform:function(){var t=new p,e=new p,r=new p,i=new p;return function(a,n,s){var o=this.series[a],u=[n,o.markPoint],h=this.deepQuery(u,"symbolSize"),c=this.deepQuery(u,"orientation"),l=this.deepQuery(u,"orientationAngle");if(this.getMarkCoord(a,n,i),p.normalize(r,i),p.cross(t,p.UP,r),p.normalize(t,t),p.cross(e,r,t),isNaN(h)||(h=[h,h]),"tangent"===c){var _=r;r=e,e=_,p.negate(r,r),p.scaleAndAdd(i,i,e,h[1])}s.x=t,s.y=e,s.z=r,v.rotateX(s,s,-l/180*Math.PI),v.scale(s,s,new p(h[0],h[1],1));var f=s._array;f[12]=i.x,f[13]=i.y,f[14]=i.z}}(),getMarkBarPoints:function(){var t=new p;return function(e,r,i,a){var n=null!=r.barHeight?r.barHeight:1;"function"==typeof n&&(n=n(r)),this.getMarkCoord(e,r,i),p.copy(t,i),p.normalize(t,t),p.scaleAndAdd(a,i,t,n)}}(),getMarkLinePoints:function(){var t=new p,e=new p,r=new p,i=new p;return function(a,n,s,o,u,h){var c=!!u;c||(h=o),this.getMarkCoord(a,n[0],s),this.getMarkCoord(a,n[1],h);var l=p.normalize,_=p.cross,f=p.sub,d=p.add;if(c){l(t,s),f(e,h,s),l(e,e),_(r,e,t),l(r,r),_(e,t,r),d(o,t,e),l(o,o),l(t,h),f(e,s,h),l(e,e),_(r,e,t),l(r,r),_(e,t,r),d(u,t,e),l(u,u),d(i,s,h),l(i,i);var m=p.dot(s,i),y=p.dot(i,o),v=2*((this._earthRadius-m)/y);p.scaleAndAdd(o,s,o,v),p.scaleAndAdd(u,h,u,v)}}}(),onframe:function(t){E.prototype.onframe.call(this,t),this._orbitControl.update(t);for(var e=0;this._vfParticleSurfaceList.length>e;e++)this._vfParticleSurfaceList[e].update(Math.min(t/1e3,.5)),this.zr.refreshNextFrame()},refresh:function(t){this.baseLayer.renderer&&(t&&(this.option=t,this.series=t.series),this._init())},ondataRange:function(){this.component.dataRange&&(this.refresh(),this.zr.refreshNextFrame())},dispose:function(){E.prototype.dispose.call(this),this.baseLayer.dispose(),this._orbitControl&&this._orbitControl.dispose(),this._globeNode=null,this._orbitControl=null,this._disposed=!0;for(var t=0;this._vfParticleSurfaceList.length>t;t++)this._vfParticleSurfaceList[t].dispose()}},r.inherits(e,E),t("echarts/chart").define(g.CHART_TYPE_MAP3D,e),e}),define("qtek/Node",["require","./core/Base","./math/Vector3","./math/Quaternion","./math/Matrix4","./dep/glmatrix"],function(t){"use strict";var e=t("./core/Base"),r=t("./math/Vector3"),i=t("./math/Quaternion"),a=t("./math/Matrix4"),n=t("./dep/glmatrix"),s=n.mat4,o=0,u=e.derive({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name="NODE_"+o++),this.position||(this.position=new r),this.rotation||(this.rotation=new i),this.scale||(this.scale=new r(1,1,1)),this.worldTransform=new a,this.localTransform=new a,this._children=[]},{visible:!0,isRenderable:function(){return!1},setName:function(t){this._scene&&(delete this._scene._nodeRepository[this.name],this._scene._nodeRepository[t]=this),this.name=t},add:function(t){this._inIterating&&console.warn("Add operation can cause unpredictable error when in iterating"),t._parent!==this&&(t._parent&&t._parent.remove(t),t._parent=this,this._children.push(t),this._scene&&this._scene!==t.scene&&t.traverse(this._addSelfToScene,this))},remove:function(t){this._inIterating&&console.warn("Remove operation can cause unpredictable error when in iterating");var e=this._children.indexOf(t);0>e||(this._children.splice(e,1),t._parent=null,this._scene&&t.traverse(this._removeSelfFromScene,this))},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(t){t._scene.removeFromScene(t),t._scene=null},_addSelfToScene:function(t){this._scene.addToScene(t),t._scene=this._scene},isAncestor:function(t){for(var e=t._parent;e;){if(e===this)return!0;e=e._parent}return!1},children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},getChildByName:function(t){for(var e=0;this._children.length>e;e++)if(this._children[e].name===t)return this._children[e]},getDescendantByName:function(t){for(var e=0;this._children.length>e;e++){var r=this._children[e];if(r.name===t)return r;var i=r.getDescendantByName(t);if(i)return i}},queryNode:function(t){if(t){for(var e=t.split("/"),r=this,i=0;e.length>i;i++){var a=e[i];if(a){for(var n=!1,s=0;r._children.length>s;s++){var o=r._children[s];if(o.name===a){r=o,n=!0;break}}if(!n)return}}return r}},getPath:function(t){if(!this._parent)return"/";for(var e=this._parent,r=this.name;e._parent&&(r=e.name+"/"+r,e._parent!=t);)e=e._parent;return!e._parent&&t?null:r},traverse:function(t,e,r){this._inIterating=!0,(void 0===r||this.constructor===r)&&t.call(e,this);for(var i=this._children,a=0,n=i.length;n>a;a++)i[a].traverse(t,e,r);this._inIterating=!1},setLocalTransform:function(t){s.copy(this.localTransform._array,t._array),this.decomposeLocalTransform()},decomposeLocalTransform:function(t){var e=t?null:this.scale;this.localTransform.decomposeMatrix(e,this.rotation,this.position)},setWorldTransform:function(t){s.copy(this.worldTransform._array,t._array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var t=s.create();return function(e){this._parent?(s.invert(t,this._parent.worldTransform._array),s.multiply(this.localTransform._array,t,this.worldTransform._array)):s.copy(this.localTransform._array,this.worldTransform._array);var r=e?null:this.scale;this.localTransform.decomposeMatrix(r,this.rotation,this.position)}}(),updateLocalTransform:function(){var t=this.position,e=this.rotation,r=this.scale;if(t._dirty||r._dirty||e._dirty){var i=this.localTransform._array;s.fromRotationTranslation(i,e._array,t._array),s.scale(i,i,r._array),e._dirty=!1,r._dirty=!1,t._dirty=!1,this._needsUpdateWorldTransform=!0}},updateWorldTransform:function(){this._parent?s.multiply(this.worldTransform._array,this._parent.worldTransform._array,this.localTransform._array):s.copy(this.worldTransform._array,this.localTransform._array)},update:function(t){this.autoUpdateLocalTransform?this.updateLocalTransform():t=!0,(t||this._needsUpdateWorldTransform)&&(this.updateWorldTransform(),t=!0,this._needsUpdateWorldTransform=!1);for(var e=0,r=this._children.length;r>e;e++)this._children[e].update(t)},getWorldPosition:function(t){var e=this.worldTransform._array;return t?(t._array[0]=e[12],t._array[1]=e[13],t._array[2]=e[14],t):new r(e[12],e[13],e[14])},clone:function(){var t=new this.constructor;t.setName(this.name),t.position.copy(this.position),t.rotation.copy(this.rotation),t.scale.copy(this.scale);for(var e=0;this._children.length>e;e++)t.add(this._children[e].clone());return t},rotateAround:function(){var t=new r,e=new a;return function(r,i,a){t.copy(this.position).subtract(r),this.localTransform.identity(),this.localTransform.translate(r),this.localTransform.rotate(a,i),e.fromRotationTranslation(this.rotation,t),this.localTransform.multiply(e),this.localTransform.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var t=new a;return function(e,r){t.lookAt(this.position,e,r||this.localTransform.y).invert(),t.decomposeMatrix(null,this.rotation,this.position)}}()});return u}),define("qtek/Mesh",["require","./Renderable","./core/glenum"],function(t){"use strict";var e=t("./Renderable"),r=t("./core/glenum"),i=e.derive({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{render:function(t,r){var i=r||this.material;if(this.skeleton){var a=this.skeleton.getSubSkinMatrices(this.__GUID__,this.joints);i.shader.setUniformBySemantic(t,"SKIN_MATRIX",a)}return e.prototype.render.call(this,t,r)}});return i.POINTS=r.POINTS,i.LINES=r.LINES,i.LINE_LOOP=r.LINE_LOOP,i.LINE_STRIP=r.LINE_STRIP,i.TRIANGLES=r.TRIANGLES,i.TRIANGLE_STRIP=r.TRIANGLE_STRIP,i.TRIANGLE_FAN=r.TRIANGLE_FAN,i.BACK=r.BACK,i.FRONT=r.FRONT,i.FRONT_AND_BACK=r.FRONT_AND_BACK,i.CW=r.CW,i.CCW=r.CCW,i}),define("qtek/geometry/Sphere",["require","../DynamicGeometry","../dep/glmatrix","../math/BoundingBox"],function(t){"use strict";var e=t("../DynamicGeometry"),r=t("../dep/glmatrix"),i=r.vec3,a=r.vec2,n=t("../math/BoundingBox"),s=e.derive({widthSegments:20,heightSegments:20,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var t=this.attributes.position.value,e=this.attributes.texcoord0.value,r=this.attributes.normal.value;t.length=0,e.length=0,r.length=0,this.faces.length=0;var s,o,u,h,c,l,_,f,d=this.heightSegments,m=this.widthSegments,y=this.radius,p=this.phiStart,v=this.phiLength,g=this.thetaStart,E=this.thetaLength,y=this.radius;for(_=0;d>=_;_++)for(l=0;m>=l;l++)h=l/m,c=_/d,s=-y*Math.cos(p+h*v)*Math.sin(g+c*E),o=y*Math.cos(g+c*E),u=y*Math.sin(p+h*v)*Math.sin(g+c*E),t.push(i.fromValues(s,o,u)),e.push(a.fromValues(h,c)),f=i.fromValues(s,o,u),i.normalize(f,f),r.push(f);var T,b,x,R,A=this.faces,S=m+1;for(_=0;d>_;_++)for(l=0;m>l;l++)b=_*S+l,T=_*S+l+1,R=(_+1)*S+l+1,x=(_+1)*S+l,A.push(i.fromValues(T,b,R)),A.push(i.fromValues(b,x,R));this.boundingBox=new n,this.boundingBox.max.set(y,y,y),this.boundingBox.min.set(-y,-y,-y)}});return s}),define("qtek/Material",["require","./core/Base","./Texture"],function(t){"use strict";var e=t("./core/Base"),r=t("./Texture"),i=e.derive({name:"",uniforms:null,shader:null,depthTest:!0,depthMask:!0,transparent:!1,blend:null,_enabledUniforms:null},function(){this.name||(this.name="MATERIAL_"+this.__GUID__),this.shader&&this.attachShader(this.shader)},{bind:function(t,e){for(var i=0,a=e&&e.shader===this.shader,n=0;this._enabledUniforms.length>n;n++){var s=this._enabledUniforms[n],o=this.uniforms[s];if(!a||e.uniforms[s].value!==o.value)if(void 0!==o.value){if(!(null===o.value||o.value instanceof Array&&!o.value.length))if(o.value instanceof r){var u=this.shader.setUniform(t,"1i",s,i);if(!u)continue;var h=o.value;t.activeTexture(t.TEXTURE0+i),h.isRenderable()?h.bind(t):h.unbind(t),i++}else if(o.value instanceof Array){if(0===o.value.length)continue;var c=o.value[0];if(c instanceof r){if(!this.shader.hasUniform(s))continue;for(var l=[],_=0;o.value.length>_;_++){var h=o.value[_];t.activeTexture(t.TEXTURE0+i),h.isRenderable()?h.bind(t):h.unbind(t),l.push(i++)}this.shader.setUniform(t,"1iv",s,l)}else this.shader.setUniform(t,o.type,s,o.value)}else this.shader.setUniform(t,o.type,s,o.value)}else console.warn('Uniform value "'+s+'" is undefined')}},setUniform:function(t,e){var r=this.uniforms[t];r&&(r.value=e)},setUniforms:function(t){for(var e in t){var r=t[e];this.setUniform(e,r)}},enableUniform:function(t){this.uniforms[t]&&!this.isUniformEnabled(t)&&this._enabledUniforms.push(t)},disableUniform:function(t){var e=this._enabledUniforms.indexOf(t);e>=0&&this._enabledUniforms.splice(e,1)},isUniformEnabled:function(t){return this._enabledUniforms.indexOf(t)>=0},set:function(t,e){if("object"==typeof t)for(var r in t){var i=t[r];this.set(r,i)}else{var a=this.uniforms[t];a&&(a.value=e)}},get:function(t){var e=this.uniforms[t];return e?e.value:void 0},attachShader:function(t,e){this.shader&&this.shader.detached();var r=this.uniforms;if(this.uniforms=t.createUniforms(),this.shader=t,this._enabledUniforms=Object.keys(this.uniforms),e)for(var i in r)this.uniforms[i]&&(this.uniforms[i].value=r[i].value);t.attached()},detachShader:function(){this.shader.detached(),this.shader=null,this.uniforms={}},clone:function(){var t=new i({name:this.name,shader:this.shader});for(var e in this.uniforms)t.uniforms[e].value=this.uniforms[e].value;return t.depthTest=this.depthTest,t.depthMask=this.depthMask,t.transparent=this.transparent,t.blend=this.blend,t},dispose:function(t,e){if(e)for(var i in this.uniforms){var a=this.uniforms[i].value;if(a)if(a instanceof r)a.dispose(t);else if(a instanceof Array)for(var n=0;a.length>n;n++)a[n]instanceof r&&a[n].dispose(t)}var s=this.shader;s&&(this.detachShader(),s.isAttachedToAny()||s.dispose(t))}});return i}),define("qtek/Texture2D",["require","./Texture","./core/glinfo","./core/glenum"],function(t){var e=t("./Texture"),r=t("./core/glinfo"),i=t("./core/glenum"),a=e.derive(function(){return{image:null,pixels:null,mipmaps:[]}},{update:function(t){t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.beforeUpdate(t);var a=this.format,n=this.type;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter);var s=r.getExtension(t,"EXT_texture_filter_anisotropic");if(s&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===n){var o=r.getExtension(t,"OES_texture_half_float");o||(n=i.FLOAT)}if(this.image?t.texImage2D(t.TEXTURE_2D,0,a,a,n,this.image):e.COMPRESSED_RGBA_S3TC_DXT5_EXT>=a&&a>=e.COMPRESSED_RGB_S3TC_DXT1_EXT?t.compressedTexImage2D(t.TEXTURE_2D,0,a,this.width,this.height,0,this.pixels):t.texImage2D(t.TEXTURE_2D,0,a,this.width,this.height,0,a,n,this.pixels),this.useMipmap)if(this.mipmaps.length){if(this.image)for(var u=0;this.mipmaps.length>u;u++)this.mipmaps[u]&&t.texImage2D(t.TEXTURE_2D,u,a,a,n,this.mipmaps[u]);else if(this.pixels)for(var h=this.width,c=this.height,u=0;this.mipmaps.length>u;u++)this.mipmaps[u]&&(e.COMPRESSED_RGBA_S3TC_DXT5_EXT>=a&&a>=e.COMPRESSED_RGB_S3TC_DXT1_EXT?t.compressedTexImage2D(t.TEXTURE_2D,0,a,h,c,0,this.mipmaps[u]):t.texImage2D(t.TEXTURE_2D,u,a,h,c,0,a,n,this.mipmaps[u])),h/=2,c/=2}else this.NPOT||this.mipmaps.length||t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},generateMipmap:function(t){t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D)},isPowerOfTwo:function(){var t,e;return this.image?(t=this.image.width,e=this.image.height):(t=this.width,e=this.height),0===(t&t-1)&&0===(e&e-1)},isRenderable:function(){return this.image?"CANVAS"===this.image.nodeName||this.image.complete:this.width&&this.height},bind:function(t){t.bindTexture(t.TEXTURE_2D,this.getWebGLTexture(t))},unbind:function(t){t.bindTexture(t.TEXTURE_2D,null)},load:function(t){var e=new Image,r=this;return e.onload=function(){r.dirty(),r.trigger("success",r),e.onload=null},e.onerror=function(){r.trigger("error",r),e.onerror=null},e.src=t,this.image=e,this}});return a}),define("qtek/math/Vector3",["require","../dep/glmatrix"],function(t){"use strict";var e=t("../dep/glmatrix"),r=e.vec3,i=function(t,e,i){t=t||0,e=e||0,i=i||0,this._array=r.fromValues(t,e,i),this._dirty=!0};if(i.prototype={constructor:i,add:function(t){return r.add(this._array,this._array,t._array),this._dirty=!0,this},set:function(t,e,r){return this._array[0]=t,this._array[1]=e,this._array[2]=r,this._dirty=!0,this},setArray:function(t){return this._array[0]=t[0],this._array[1]=t[1],this._array[2]=t[2],this._dirty=!0,this},clone:function(){return new i(this.x,this.y,this.z)},copy:function(t){return r.copy(this._array,t._array),this._dirty=!0,this},cross:function(t,e){return r.cross(t._array,this._array,e._array),t._dirty=!0,this},dist:function(t){return r.dist(this._array,t._array)},distance:function(t){return r.distance(this._array,t._array)},div:function(t){return r.div(this._array,this._array,t._array),this._dirty=!0,this},divide:function(t){return r.divide(this._array,this._array,t._array),this._dirty=!0,this},dot:function(t){return r.dot(this._array,t._array)},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(t,e,i){return r.lerp(this._array,t._array,e._array,i),this._dirty=!0,this},min:function(t){return r.min(this._array,this._array,t._array),this._dirty=!0,this},max:function(t){return r.max(this._array,this._array,t._array),this._dirty=!0,this},mul:function(t){return r.mul(this._array,this._array,t._array),this._dirty=!0,this},multiply:function(t){return r.multiply(this._array,this._array,t._array),this._dirty=!0,this},negate:function(){return r.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},random:function(t){return r.random(this._array,t),this._dirty=!0,this},scale:function(t){return r.scale(this._array,this._array,t),this._dirty=!0,this},scaleAndAdd:function(t,e){return r.scaleAndAdd(this._array,this._array,t._array,e),this._dirty=!0,this},sqrDist:function(t){return r.sqrDist(this._array,t._array)},squaredDistance:function(t){return r.squaredDistance(this._array,t._array)},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},sub:function(t){return r.sub(this._array,this._array,t._array),this._dirty=!0,this},subtract:function(t){return r.subtract(this._array,this._array,t._array),this._dirty=!0,this},transformMat3:function(t){return r.transformMat3(this._array,this._array,t._array),this._dirty=!0,this},transformMat4:function(t){return r.transformMat4(this._array,this._array,t._array),this._dirty=!0,this},transformQuat:function(t){return r.transformQuat(this._array,this._array,t._array),this._dirty=!0,this},applyProjection:function(t){var e=this._array;if(t=t._array,0===t[15]){var r=-1/e[2];e[0]=t[0]*e[0]*r,e[1]=t[5]*e[1]*r,e[2]=(t[10]*e[2]+t[14])*r}else e[0]=t[0]*e[0]+t[12],e[1]=t[5]*e[1]+t[13],e[2]=t[10]*e[2]+t[14];return this._dirty=!0,this},setEulerFromQuaternion:function(){},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var a=i.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]=t,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]=t,this._dirty=!0}}),Object.defineProperty(a,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]=t,this._dirty=!0}})}return i.add=function(t,e,i){return r.add(t._array,e._array,i._array),t._dirty=!0,t},i.set=function(t,e,i,a){r.set(t._array,e,i,a),t._dirty=!0},i.copy=function(t,e){return r.copy(t._array,e._array),t._dirty=!0,t},i.cross=function(t,e,i){return r.cross(t._array,e._array,i._array),t._dirty=!0,t},i.dist=function(t,e){return r.distance(t._array,e._array)},i.distance=i.dist,i.div=function(t,e,i){return r.divide(t._array,e._array,i._array),t._dirty=!0,t},i.divide=i.div,i.dot=function(t,e){return r.dot(t._array,e._array)},i.len=function(t){return r.length(t._array)},i.lerp=function(t,e,i,a){return r.lerp(t._array,e._array,i._array,a),t._dirty=!0,t},i.min=function(t,e,i){return r.min(t._array,e._array,i._array),t._dirty=!0,t},i.max=function(t,e,i){return r.max(t._array,e._array,i._array),t._dirty=!0,t},i.mul=function(t,e,i){return r.multiply(t._array,e._array,i._array),t._dirty=!0,t},i.multiply=i.mul,i.negate=function(t,e){return r.negate(t._array,e._array),t._dirty=!0,t},i.normalize=function(t,e){return r.normalize(t._array,e._array),t._dirty=!0,t},i.random=function(t,e){return r.random(t._array,e),t._dirty=!0,t},i.scale=function(t,e,i){return r.scale(t._array,e._array,i),t._dirty=!0,t},i.scaleAndAdd=function(t,e,i,a){return r.scaleAndAdd(t._array,e._array,i._array,a),t._dirty=!0,t},i.sqrDist=function(t,e){return r.sqrDist(t._array,e._array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(t){return r.sqrLen(t._array)},i.squaredLength=i.sqrLen,i.sub=function(t,e,i){return r.subtract(t._array,e._array,i._array),t._dirty=!0,t},i.subtract=i.sub,i.transformMat3=function(t,e,i){return r.transformMat3(t._array,e._array,i._array),t._dirty=!0,t},i.transformMat4=function(t,e,i){return r.transformMat4(t._array,e._array,i._array),t._dirty=!0,t},i.transformQuat=function(t,e,i){return r.transformQuat(t._array,e._array,i._array),t._dirty=!0,t},i.POSITIVE_X=new i(1,0,0),i.NEGATIVE_X=new i(-1,0,0),i.POSITIVE_Y=new i(0,1,0),i.NEGATIVE_Y=new i(0,-1,0),i.POSITIVE_Z=new i(0,0,1),i.NEGATIVE_Z=new i(0,0,-1),i.UP=new i(0,1,0),i.ZERO=new i(0,0,0),i}),define("qtek/math/Matrix4",["require","../dep/glmatrix","./Vector3"],function(t){"use strict";
var e=t("../dep/glmatrix"),r=t("./Vector3"),i=e.mat4,a=e.vec3,n=e.mat3,s=e.quat,o=function(){this._axisX=new r,this._axisY=new r,this._axisZ=new r,this._array=i.create(),this._dirty=!0};if(o.prototype={constructor:o,adjoint:function(){return i.adjoint(this._array,this._array),this._dirty=!0,this},clone:function(){return(new o).copy(this)},copy:function(t){return i.copy(this._array,t._array),this._dirty=!0,this},determinant:function(){return i.determinant(this._array)},fromQuat:function(t){return i.fromQuat(this._array,t._array),this._dirty=!0,this},fromRotationTranslation:function(t,e){return i.fromRotationTranslation(this._array,t._array,e._array),this._dirty=!0,this},fromMat2d:function(t){return o.fromMat2d(this,t),this},frustum:function(t,e,r,a,n,s){return i.frustum(this._array,t,e,r,a,n,s),this._dirty=!0,this},identity:function(){return i.identity(this._array),this._dirty=!0,this},invert:function(){return i.invert(this._array,this._array),this._dirty=!0,this},lookAt:function(t,e,r){return i.lookAt(this._array,t._array,e._array,r._array),this._dirty=!0,this},mul:function(t){return i.mul(this._array,this._array,t._array),this._dirty=!0,this},mulLeft:function(t){return i.mul(this._array,t._array,this._array),this._dirty=!0,this},multiply:function(t){return i.multiply(this._array,this._array,t._array),this._dirty=!0,this},multiplyLeft:function(t){return i.multiply(this._array,t._array,this._array),this._dirty=!0,this},ortho:function(t,e,r,a,n,s){return i.ortho(this._array,t,e,r,a,n,s),this._dirty=!0,this},perspective:function(t,e,r,a){return i.perspective(this._array,t,e,r,a),this._dirty=!0,this},rotate:function(t,e){return i.rotate(this._array,this._array,t,e._array),this._dirty=!0,this},rotateX:function(t){return i.rotateX(this._array,this._array,t),this._dirty=!0,this},rotateY:function(t){return i.rotateY(this._array,this._array,t),this._dirty=!0,this},rotateZ:function(t){return i.rotateZ(this._array,this._array,t),this._dirty=!0,this},scale:function(t){return i.scale(this._array,this._array,t._array),this._dirty=!0,this},translate:function(t){return i.translate(this._array,this._array,t._array),this._dirty=!0,this},transpose:function(){return i.transpose(this._array,this._array),this._dirty=!0,this},decomposeMatrix:function(){var t=a.create(),e=a.create(),r=a.create(),i=n.create();return function(o,u,h){var c=this._array;a.set(t,c[0],c[1],c[2]),a.set(e,c[4],c[5],c[6]),a.set(r,c[8],c[9],c[10]);var l=a.length(t),_=a.length(e),f=a.length(r);o&&(o.x=l,o.y=_,o.z=f,o._dirty=!0),h.set(c[12],c[13],c[14]),n.fromMat4(i,c),n.transpose(i,i),i[0]/=l,i[1]/=l,i[2]/=l,i[3]/=_,i[4]/=_,i[5]/=_,i[6]/=f,i[7]/=f,i[8]/=f,s.fromMat3(u._array,i),s.normalize(u._array,u._array),u._dirty=!0,h._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var u=o.prototype;Object.defineProperty(u,"z",{get:function(){var t=this._array;return this._axisZ.set(t[8],t[9],t[10]),this._axisZ},set:function(t){var e=this._array;t=t._array,e[8]=t[0],e[9]=t[1],e[10]=t[2],this._dirty=!0}}),Object.defineProperty(u,"y",{get:function(){var t=this._array;return this._axisY.set(t[4],t[5],t[6]),this._axisY},set:function(t){var e=this._array;t=t._array,e[4]=t[0],e[5]=t[1],e[6]=t[2],this._dirty=!0}}),Object.defineProperty(u,"x",{get:function(){var t=this._array;return this._axisX.set(t[0],t[1],t[2]),this._axisX},set:function(t){var e=this._array;t=t._array,e[0]=t[0],e[1]=t[1],e[2]=t[2],this._dirty=!0}})}return o.adjoint=function(t,e){return i.adjoint(t._array,e._array),t._dirty=!0,t},o.copy=function(t,e){return i.copy(t._array,e._array),t._dirty=!0,t},o.determinant=function(t){return i.determinant(t._array)},o.identity=function(t){return i.identity(t._array),t._dirty=!0,t},o.ortho=function(t,e,r,a,n,s,o){return i.ortho(t._array,e,r,a,n,s,o),t._dirty=!0,t},o.perspective=function(t,e,r,a,n){return i.perspective(t._array,e,r,a,n),t._dirty=!0,t},o.lookAt=function(t,e,r,a){return i.lookAt(t._array,e._array,r._array,a._array),t._dirty=!0,t},o.invert=function(t,e){return i.invert(t._array,e._array),t._dirty=!0,t},o.mul=function(t,e,r){return i.mul(t._array,e._array,r._array),t._dirty=!0,t},o.multiply=o.mul,o.fromQuat=function(t,e){return i.fromQuat(t._array,e._array),t._dirty=!0,t},o.fromRotationTranslation=function(t,e,r){return i.fromRotationTranslation(t._array,e._array,r._array),t._dirty=!0,t},o.fromMat2d=function(t,e){t._dirty=!0;var e=e._array,t=t._array;return t[0]=e[0],t[4]=e[2],t[12]=e[4],t[1]=e[1],t[5]=e[3],t[13]=e[5],t},o.rotate=function(t,e,r,a){return i.rotate(t._array,e._array,r,a._array),t._dirty=!0,t},o.rotateX=function(t,e,r){return i.rotateX(t._array,e._array,r),t._dirty=!0,t},o.rotateY=function(t,e,r){return i.rotateY(t._array,e._array,r),t._dirty=!0,t},o.rotateZ=function(t,e,r){return i.rotateZ(t._array,e._array,r),t._dirty=!0,t},o.scale=function(t,e,r){return i.scale(t._array,e._array,r._array),t._dirty=!0,t},o.transpose=function(t,e){return i.transpose(t._array,e._array),t._dirty=!0,t},o.translate=function(t,e,r){return i.translate(t._array,e._array,r._array),t._dirty=!0,t},o}),define("qtek/core/glenum",[],function(){return{DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444}}),define("echarts-x/chart/base3d",["require","echarts/config","zrender/tool/util","../component/base3d","../util/color","qtek/core/LRU","qtek/math/Vector3","qtek/math/Matrix4","../entity/marker/MarkLine","../entity/marker/MarkBar","../entity/marker/MarkPoint","../entity/marker/LargeMarkPoint"],function(t){"use strict";function e(t,e,r,i,n){a.call(this,t,e,r,i,n),this._markLineList=[],this._markLineCount=0,this._markPointList=[],this._markPointCount=0,this._markBarList=[],this._markBarCount=0,this._largeMarkPointList=[],this._largeMarkPointCount=0,this._markList=[]}var r=t("echarts/config"),i=t("zrender/tool/util"),a=t("../component/base3d"),n=t("../util/color"),s=t("qtek/core/LRU"),o=t("qtek/math/Vector3"),u=t("qtek/math/Matrix4"),h={markLine:t("../entity/marker/MarkLine"),markBar:t("../entity/marker/MarkBar"),markPoint:t("../entity/marker/MarkPoint"),largeMarkPoint:t("../entity/marker/LargeMarkPoint")};return e.prototype={constructor:e,beforeBuildMark:function(){for(var t=0;this._markList.length>t;t++)this._markList[t].clear();this._markList.length=0,this._markBarCount=0,this._markPointCount=0,this._markLineCount=0,this._largeMarkPointCount=0},buildMark:function(t,e){var a=this.series[t];a.markPoint&&(i.merge(i.merge(a.markPoint,this.ecTheme.markPoint||{}),r.markPoint),a.markPoint.large?this._buildSingleTypeMarker("largeMarkPoint",t,e):this._buildSingleTypeMarker("markPoint",t,e)),a.markLine&&(i.merge(i.merge(a.markLine,this.ecTheme.markLine||{}),r.markLine),this._buildSingleTypeMarker("markLine",t,e)),a.markBar&&(i.merge(i.merge(a.markBar,this.ecTheme.markBar||{}),r.markBar),this._buildSingleTypeMarker("markBar",t,e))},afterBuildMark:function(){for(var t=this._markPointCount;this._markPointList.length>t;t++)this._disposeSingleSerieMark(this._markPointList[t]);this._markPointList.length=this._markPointCount;for(var t=this._largeMarkPointCount;this._largeMarkPointList.length>t;t++)this._disposeSingleSerieMark(this._largeMarkPointList[t]);this._largeMarkPointList.length=this._largeMarkPointCount;for(var t=this._markLineCount;this._markLineList.length>t;t++)this._disposeSingleSerieMark(this._markLineList[t]);this._markLineList.length=this._markLineCount;for(var t=this._markBarCount;this._markBarList.length>t;t++)this._disposeSingleSerieMark(this._markBarList[t]);this._markBarList.length=this._markBarCount},_disposeSingleSerieMark:function(t){var e=t.getSceneNode();e.getParent()&&e.getParent().remove(e),t.dispose()},_buildSingleTypeMarker:function(t,e,r){var i=this.series[e],a=this["_"+t+"List"],n=this["_"+t+"Count"],s=h[t];if(a&&s){a[n]||(a[n]=new s(this));var o=a[n];o.setSeries(i,e);var u=o.getSceneNode();u.getParent()!==r&&r.add(u),this["_"+t+"Count"]++,this._markList.push(o)}},parseColor:function(t){if(!t)return null;if(t instanceof Array)return t;this._colorCache||(this._colorCache=new s(10));var e=this._colorCache.get(t);return e||(e=n.parse(t),this._colorCache.put(t,e),e[0]/=255,e[1]/=255,e[2]/=255),e},getMarkCoord:function(t,e,r){r._array[0]=e.x,r._array[1]=e.y,r._array[2]=e.z},getMarkPointTransform:function(t,e,r){u.identity(r);var i=new o;this.getMarkCoord(t,e,i);var a=r._array;a[12]=i.x,a[13]=i.y,a[14]=i.z},getMarkBarPoints:function(t,e,r,i){var a=null!=e.barHeight?e.barHeight:1;"function"==typeof a&&(a=a(e)),this.getMarkCoord(t,e,r),o.scaleAndAdd(i,i,r,1)},getMarkLinePoints:function(t,e,r,i,a,n){var s=!!a;s||(n=i),this.getMarkCoord(t,e[0],r),this.getMarkCoord(t,e[1],n),s&&(o.copy(i,r),o.copy(a,n))},getSerieLabelText:function(t,e,r,i){var a=this.deepQuery([e,t],"itemStyle."+i+".label.formatter");a||"emphasis"!==i||(a=this.deepQuery([e,t],"itemStyle.normal.label.formatter"));var n=this.getDataFromOption(e,"-");return a?"function"==typeof a?a.call(this.myChart,{seriesName:t.name,series:t,name:r,value:n,data:e,status:i}):"string"==typeof a?a=a.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}").replace("{a0}",t.name).replace("{b0}",r).replace("{c0}",this.numAddCommas(n)):void 0:n instanceof Array?null!=n[2]?this.numAddCommas(n[2]):n[0]+" , "+n[1]:this.numAddCommas(n)},onlegendSelected:function(t,e){var r=t.selected;for(var i in this.selectedMap)this.selectedMap[i]!=r[i]&&(e.needRefresh=!0),this.selectedMap[i]=r[i]},dispose:function(){a.prototype.dispose.call(this);for(var t=0;this._markList.length>t;t++)this._disposeSingleSerieMark(this._markList[t])},onframe:function(t){for(var e=0;this._markList.length>e;e++)this._markList[e].onframe(t)}},i.inherits(e,a),e}),define("echarts-x/util/OrbitControl",["require","zrender/config","qtek/math/Vector2"],function(t){"use strict";var e=t("zrender/config"),r=t("qtek/math/Vector2"),i=e.EVENT,a=function(t,e,i){this.zr=e,this.layer=i,this.target=t,this.autoRotate=!1,this.minZoom=.5,this.maxZoom=1.5,this._zoom=1,this._rotateY=0,this._rotateX=0,this._mouseX=0,this._mouseY=0,this._rotateVelocity=new r,this._zoomSpeed=0};return a.prototype={constructor:a,init:function(){this.layer.bind(i.MOUSEDOWN,this._mouseDownHandler,this),this.layer.bind(i.MOUSEWHEEL,this._mouseWheelHandler,this)},dispose:function(){this.layer.unbind(i.MOUSEDOWN,this._mouseDownHandler),this.layer.unbind(i.MOUSEMOVE,this._mouseMoveHandler),this.layer.unbind(i.MOUSEUP,this._mouseUpHandler),this.layer.unbind(i.MOUSEWHEEL,this._mouseWheelHandler)},update:function(t){this._rotateY=(this._rotateVelocity.y+this._rotateY)%(2*Math.PI),this._rotateX=(this._rotateVelocity.x+this._rotateX)%(2*Math.PI),this._rotateX=Math.max(Math.min(this._rotateX,Math.PI/2),-Math.PI/2),this._zoom+=this._zoomSpeed,this._zoom=Math.max(Math.min(this._zoom,this.maxZoom),this.minZoom),this.target.rotation.identity().rotateX(this._rotateX).rotateY(this._rotateY);var e=this._zoom;this.target.scale.set(e,e,e),this.autoRotate?(this._rotateY-=1e-4*t,this.zr.refreshNextFrame()):(this._rotateVelocity.len()>0||0!==this._zoomSpeed)&&this.zr.refreshNextFrame();var r=this._rotateVelocity.len();r=.8*r,1e-4>r&&(r=0),this._rotateVelocity.normalize().scale(r),this._zoomSpeed*=.8,.001>Math.abs(this._zoomSpeed)&&(this._zoomSpeed=0)},_mouseDownHandler:function(t){this.layer.bind(i.MOUSEMOVE,this._mouseMoveHandler,this),this.layer.bind(i.MOUSEUP,this._mouseUpHandler,this),t=t.event,this._rotateVelocity.set(0,0),this._mouseX=t.pageX,this._mouseY=t.pageY,this.autoRotate&&(this.autoRotate=!1)},_mouseMoveHandler:function(t){t=t.event,this._rotateVelocity.y=(t.pageX-this._mouseX)/500,this._rotateVelocity.x=(t.pageY-this._mouseY)/500,this._mouseX=t.pageX,this._mouseY=t.pageY},_mouseWheelHandler:function(t){t=t.event;var e=t.wheelDelta||-t.detail;this._zoomSpeed=e>0?.05:-.05},_mouseUpHandler:function(){this.layer.unbind(i.MOUSEMOVE,this._mouseMoveHandler,this),this.layer.unbind(i.MOUSEUP,this._mouseUpHandler,this)}},a}),define("echarts-x/surface/ZRenderSurface",["require","zrender/Storage","qtek/Texture2D","qtek/math/Vector3","qtek/math/Vector2"],function(t){var e=t("zrender/Storage"),r=t("qtek/Texture2D"),i=t("qtek/math/Vector3"),a=t("qtek/math/Vector2"),n=function(t,i){this.onrefresh=function(){},this._storage=new e,this._canvas=document.createElement("canvas"),this._width=t||512,this._height=i||512,this._canvas.width=this._width,this._canvas.height=this._height,this._ctx=this._canvas.getContext("2d"),this._texture=new r({image:this._canvas,anisotropic:32,flipY:!1}),this.refreshNextTick=this.refreshNextTick.bind(this)};return n.prototype={constructor:n,backgroundColor:"",backgroundImage:null,addElement:function(t){this._storage.addRoot(t)},delElement:function(t){this._storage.delRoot(t)},clearElements:function(){this._storage.delRoot()},getTexture:function(){return this._texture},resize:function(t,e){(this._width!==t||this._height!==e)&&(this._width=t,this._height=e,this._canvas.width=t,this._canvas.height=e,this.refresh())},getWidth:function(){return this._width},getHeight:function(){return this._height},refresh:function(){var t=this._ctx;t.clearRect(0,0,this._width,this._height),this.backgroundColor&&(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this._width,this._height));var e=this.backgroundImage;e&&e.width&&e.height&&t.drawImage(this.backgroundImage,0,0,this._width,this._height);for(var r=this._storage.getShapeList(!0),i=0;r.length>i;i++){var a=r[i];a.invisible||a.brush(t,a.isHighlight,this.refreshNextTick)}this._texture.dirty(),this.onrefresh&&this.onrefresh()},refreshNextTick:function(){var t;return function(){var e=this;t&&clearTimeout(t),t=setTimeout(function(){e.refresh()},16)}}(),hover:function(t){for(var e=this._storage.getShapeList(),r=this.pick(t.target,t.face,t.point,e),i=!1,a=0;e.length>a;a++)e[a].isHighlight=!1,e[a].zlevel=0,(e[a]==r&&!e[a].isHighlight||e[a]!=r&&e[a].isHighlight)&&(i=!0);return r&&(r.isHighlight=!0,r.zlevel=10),i&&this.refresh(),r},pick:function(){var t=new i,e=new i,r=new i,n=new a,s=new a,o=new a,u=new a,h=new i;return function(c,l,_,f){var d=c.geometry,m=d.attributes.position,y=d.attributes.texcoord0;m.get(l[0],t),m.get(l[1],e),m.get(l[2],r),y.get(l[0],n),y.get(l[1],s),y.get(l[2],o),i.cross(h,e,r);var p=i.dot(t,h),v=i.dot(_,h)/p;i.cross(h,r,t);var g=i.dot(_,h)/p;i.cross(h,t,e);var E=i.dot(_,h)/p;a.scale(u,n,v),a.scaleAndAdd(u,u,s,g),a.scaleAndAdd(u,u,o,E);for(var T=u.x*this._width,b=u.y*this._height,f=f||this._storage.getShapeList(),x=f.length-1;x>=0;x--){var R=f[x];if(!R.isSilent()&&R.isCover(T,b))return R}}}()},n}),define("echarts-x/surface/VectorFieldParticleSurface",["require","qtek/compositor/Pass","qtek/StaticGeometry","qtek/Mesh","qtek/Material","qtek/Shader","qtek/Texture2D","qtek/core/glenum","qtek/camera/Orthographic","qtek/Scene","qtek/FrameBuffer","../util/sprite"],function(t){var e=t("qtek/compositor/Pass"),r=t("qtek/StaticGeometry"),i=t("qtek/Mesh"),a=t("qtek/Material"),n=t("qtek/Shader"),s=t("qtek/Texture2D"),o=t("qtek/core/glenum"),u=t("qtek/camera/Orthographic"),h=t("qtek/Scene"),c=t("qtek/FrameBuffer"),l=t("../util/sprite"),_=function(t){this.renderer=t,this.motionBlurFactor=.99,this.vectorFieldTexture=null,this.particleLife=[10,20],this.particleSizeScaling=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this.surfaceTexture=null,this.surfaceMesh=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particleMesh=null,this._frameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._motionBlurPass=null,this._thisFrameTexture=null,this._lastFrameTexture=null};return _.prototype={constructor:_,init:function(t,_){var f=new r({mainAttribute:"texcoord0"}),d=t*_,m=f.attributes;m.texcoord0.init(d);for(var y=new Float32Array(4*d),p=0,v=this.particleLife,g=0;t>g;g++)for(var E=0;_>E;E++,p++){m.texcoord0.value[2*p]=g/t,m.texcoord0.value[2*p+1]=E/_,y[4*p]=Math.random(),y[4*p+1]=Math.random(),y[4*p+2]=Math.random();var T=(v[1]-v[0])*Math.random()+v[0];y[4*p+3]=T}var b={width:t,height:_,type:o.FLOAT,minFilter:o.NEAREST,magFilter:o.NEAREST,wrapS:o.REPEAT,wrapT:o.REPEAT,useMipmap:!1};this._spawnTexture=new s(b),this._spawnTexture.pixels=y,this._particleTexture0=new s(b),this._particleTexture1=new s(b),this._frameBuffer=new c,this._particlePass=new e({fragment:n.source("ecx.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._particlePass.setUniform("speedScaling",this.particleSpeedScaling),this._motionBlurPass=new e({fragment:n.source("ecx.motionBlur.fragment")}),this._motionBlurPass.setUniform("percent",this.motionBlurFactor);var x=new i({material:new a({shader:new n({vertex:n.source("ecx.vfParticle.renderPoints.vertex"),fragment:n.source("ecx.vfParticle.renderPoints.fragment")})}),mode:o.POINTS,geometry:f});x.material.set("spriteTexture",new s({image:l.makeSimpleSprite(128)})),x.material.set("sizeScaling",this.particleSizeScaling*this.renderer.getDevicePixelRatio()),x.material.set("color",this.particleColor),this._particleMesh=x,this._scene=new h,this._scene.add(this._particleMesh),this._camera=new u,this.surfaceTexture||(this.surfaceTexture=new s({width:1024,height:1024}));var R=this.surfaceTexture.width,A=this.surfaceTexture.height;this._lastFrameTexture=new s({width:R,height:A}),this._thisFrameTexture=new s({width:R,height:A})},update:function(t){var e=this._frameBuffer,r=this._particlePass,i=this._motionBlurPass;r.attachOutput(this._particleTexture1),r.setUniform("particleTexture",this._particleTexture0),r.setUniform("deltaTime",t),r.setUniform("elapsedTime",this._elapsedTime),r.render(this.renderer,e),this._particleMesh.material.set("particleTexture",this._particleTexture1),e.attach(this.renderer.gl,this._thisFrameTexture),e.bind(this.renderer),this.renderer.render(this._scene,this._camera),e.unbind(this.renderer),i.attachOutput(this.surfaceTexture),i.setUniform("lastFrame",this._lastFrameTexture),i.setUniform("thisFrame",this._thisFrameTexture),i.render(this.renderer,e),this._swapTexture(),this.surfaceMesh&&this.surfaceMesh.material.set("diffuseMap",this.surfaceTexture),this._elapsedTime+=t},_swapTexture:function(){var t=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=t;var t=this.surfaceTexture;this.surfaceTexture=this._lastFrameTexture,this._lastFrameTexture=t},dispose:function(){var t=this.renderer;t.disposeFrameBuffer(this._frameBuffer),t.disposeTexture(this.vectorFieldTexture),t.disposeTexture(this._spawnTexture),t.disposeTexture(this._particleTexture0),t.disposeTexture(this._particleTexture1),t.disposeTexture(this._thisFrameTexture),t.disposeTexture(this._lastFrameTexture),t.disposeScene(this._scene)}},_}),define("qtek/core/LRU",["require","./LinkedList"],function(t){"use strict";var e=t("./LinkedList"),r=function(t){this._list=new e,this._map={},this._maxSize=t||10};return r.prototype.setMaxSize=function(t){this._maxSize=t},r.prototype.put=function(t,e){if(this._map[t]===void 0){var r=this._list.length();if(r>=this._maxSize&&r>0){var i=this._list.head;this._list.remove(i),delete this._map[i.key]}var a=this._list.insert(e);a.key=t,this._map[t]=a}},r.prototype.get=function(t){var e=this._map[t];return e!==void 0?(e!==this._list.tail&&(this._list.remove(e),this._list.insertEntry(e)),e.value):void 0},r.prototype.remove=function(t){var e=this._map[t];e!==void 0&&(delete this._map[t],this._list.remove(e))},r.prototype.clear=function(){this._list.clear(),this._map={}},r}),define("qtek/math/Quaternion",["require","../dep/glmatrix"],function(t){"use strict";var e=t("../dep/glmatrix"),r=e.quat,i=function(t,e,i,a){t=t||0,e=e||0,i=i||0,a=void 0===a?1:a,this._array=r.fromValues(t,e,i,a),this._dirty=!0};if(i.prototype={constructor:i,add:function(t){return r.add(this._array,this._array,t._array),this._dirty=!0,this},calculateW:function(){return r.calculateW(this._array,this._array),this._dirty=!0,this},set:function(t,e,r,i){return this._array[0]=t,this._array[1]=e,this._array[2]=r,this._array[3]=i,this._dirty=!0,this},setArray:function(t){return this._array[0]=t[0],this._array[1]=t[1],this._array[2]=t[2],this._array[3]=t[3],this._dirty=!0,this},clone:function(){return new i(this.x,this.y,this.z,this.w)},conjugate:function(){return r.conjugate(this._array,this._array),this._dirty=!0,this},copy:function(t){return r.copy(this._array,t._array),this._dirty=!0,this},dot:function(t){return r.dot(this._array,t._array)},fromMat3:function(t){return r.fromMat3(this._array,t._array),this._dirty=!0,this},fromMat4:function(){var t=e.mat3,i=t.create();return function(e){return t.fromMat4(i,e._array),t.transpose(i,i),r.fromMat3(this._array,i),this._dirty=!0,this}}(),identity:function(){return r.identity(this._array),this._dirty=!0,this},invert:function(){return r.invert(this._array,this._array),this._dirty=!0,this},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(t,e,i){return r.lerp(this._array,t._array,e._array,i),this._dirty=!0,this},mul:function(t){return r.mul(this._array,this._array,t._array),this._dirty=!0,this},mulLeft:function(t){return r.multiply(this._array,t._array,this._array),this._dirty=!0,this},multiply:function(t){return r.multiply(this._array,this._array,t._array),this._dirty=!0,this},multiplyLeft:function(t){return r.multiply(this._array,t._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},rotateX:function(t){return r.rotateX(this._array,this._array,t),this._dirty=!0,this},rotateY:function(t){return r.rotateY(this._array,this._array,t),this._dirty=!0,this},rotateZ:function(t){return r.rotateZ(this._array,this._array,t),this._dirty=!0,this},rotationTo:function(t,e){return r.rotationTo(this._array,t._array,e._array),this._dirty=!0,this},setAxes:function(t,e,i){return r.setAxes(this._array,t._array,e._array,i._array),this._dirty=!0,this},setAxisAngle:function(t,e){return r.setAxisAngle(this._array,t._array,e),this._dirty=!0,this},slerp:function(t,e,i){return r.slerp(this._array,t._array,e._array,i),this._dirty=!0,this},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},setFromEuler:function(){},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var a=i.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]=t,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]=t,this._dirty=!0}}),Object.defineProperty(a,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]=t,this._dirty=!0}}),Object.defineProperty(a,"w",{get:function(){return this._array[3]},set:function(t){this._array[3]=t,this._dirty=!0}})}return i.add=function(t,e,i){return r.add(t._array,e._array,i._array),t._dirty=!0,t},i.set=function(t,e,i,a,n){r.set(t._array,e,i,a,n),t._dirty=!0},i.copy=function(t,e){return r.copy(t._array,e._array),t._dirty=!0,t},i.calculateW=function(t,e){return r.calculateW(t._array,e._array),t._dirty=!0,t},i.conjugate=function(t,e){return r.conjugate(t._array,e._array),t._dirty=!0,t},i.identity=function(t){return r.identity(t._array),t._dirty=!0,t},i.invert=function(t,e){return r.invert(t._array,e._array),t._dirty=!0,t},i.dot=function(t,e){return r.dot(t._array,e._array)},i.len=function(t){return r.length(t._array)},i.lerp=function(t,e,i,a){return r.lerp(t._array,e._array,i._array,a),t._dirty=!0,t},i.slerp=function(t,e,i,a){return r.slerp(t._array,e._array,i._array,a),t._dirty=!0,t},i.mul=function(t,e,i){return r.multiply(t._array,e._array,i._array),t._dirty=!0,t},i.multiply=i.mul,i.rotateX=function(t,e,i){return r.rotateX(t._array,e._array,i),t._dirty=!0,t},i.rotateY=function(t,e,i){return r.rotateY(t._array,e._array,i),t._dirty=!0,t},i.rotateZ=function(t,e,i){return r.rotateZ(t._array,e._array,i),t._dirty=!0,t},i.setAxisAngle=function(t,e,i){return r.setAxisAngle(t._array,e._array,i),t._dirty=!0,t},i.normalize=function(t,e){return r.normalize(t._array,e._array),t._dirty=!0,t},i.sqrLen=function(t){return r.sqrLen(t._array)},i.squaredLength=i.sqrLen,i.fromMat3=function(t,e){return r.fromMat3(t._array,e._array),t._dirty=!0,t},i.setAxes=function(t,e,i,a){return r.setAxes(t._array,e._array,i._array,a._array),t._dirty=!0,t},i.rotationTo=function(t,e,i){return r.rotationTo(t._array,e._array,i._array),t._dirty=!0,t},i}),define("qtek/Renderable",["require","./Node","./core/glenum","./core/glinfo","./DynamicGeometry"],function(t){"use strict";function e(t,e,r){this.availableAttributes=t,this.availableAttributeSymbols=e,this.indicesBuffer=r,this.vao=null}var r,i=t("./Node"),a=t("./core/glenum"),n=t("./core/glinfo"),s=t("./DynamicGeometry"),o=0,u=null,h=!0,c=function(){this.faceNumber=0,this.vertexNumber=0,this.drawCallNumber=0},l=i.derive({material:null,geometry:null,mode:a.TRIANGLES,_drawCache:null,_renderInfo:null},function(){this._drawCache={},this._renderInfo=new c},{lineWidth:1,culling:!0,cullFace:a.BACK,frontFace:a.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&this.visible},render:function(t,i){var c=i||this.material,l=c.shader,_=this.geometry,f=this.mode,d=_.getVertexNumber(),m=_.isUseFace(),y=n.getExtension(t,"OES_element_index_uint"),p=y&&d>65535,v=p?t.UNSIGNED_INT:t.UNSIGNED_SHORT,g=n.getExtension(t,"OES_vertex_array_object"),E=!_.dynamic,T=this._renderInfo;T.vertexNumber=d,T.faceNumber=0,T.drawCallNumber=0;var b=!1;if(r=t.__GLID__+"-"+_.__GUID__+"-"+l.__GUID__,r!==o?b=!0:(_ instanceof s&&d>65535&&!y&&m||g&&E||_._cache.isDirty())&&(b=!0),o=r,b){var x=this._drawCache[r];if(!x){var R=_.getBufferChunks(t);if(!R)return;x=[];for(var A=0;R.length>A;A++){for(var S=R[A],N=S.attributeBuffers,I=S.indicesBuffer,M=[],P=[],L=0;N.length>L;L++){var w,O=N[L],k=O.name,C=O.semantic;
if(C){var D=l.attribSemantics[C];w=D&&D.symbol}else w=k;w&&l.attributeTemplates[w]&&(M.push(O),P.push(w))}var B=new e(M,P,I);x.push(B)}E&&(this._drawCache[r]=x)}for(var U=0;x.length>U;U++){var B=x[U],F=!0;g&&E&&(null==B.vao?B.vao=g.createVertexArrayOES():F=!1,g.bindVertexArrayOES(B.vao));var M=B.availableAttributes,I=B.indicesBuffer;if(F)for(var q=l.enableAttributes(t,B.availableAttributeSymbols,g&&E&&B.vao),L=0;M.length>L;L++){var V=q[L];if(-1!==V){var G,O=M[L],z=O.buffer,W=O.size;switch(O.type){case"float":G=t.FLOAT;break;case"byte":G=t.BYTE;break;case"ubyte":G=t.UNSIGNED_BYTE;break;case"short":G=t.SHORT;break;case"ushort":G=t.UNSIGNED_SHORT;break;default:G=t.FLOAT}t.bindBuffer(t.ARRAY_BUFFER,z),t.vertexAttribPointer(V,W,G,!1,0,0)}}(f==a.LINES||f==a.LINE_STRIP||f==a.LINE_LOOP)&&t.lineWidth(this.lineWidth),u=I,h=_.isUseFace(),h?(F&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,I.buffer),t.drawElements(f,I.count,v,0),T.faceNumber+=I.count/3):t.drawArrays(f,0,d),g&&E&&g.bindVertexArrayOES(null),T.drawCallNumber++}}else h?(t.drawElements(f,u.count,v,0),T.faceNumber=u.count/3):t.drawArrays(f,0,d),T.drawCallNumber=1;return T},clone:function(){var t=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling"];return function(){var e=i.prototype.clone.call(this);e.geometry=this.geometry,e.material=this.material;for(var r=0;t.length>r;r++){var a=t[r];e[a]!==this[a]&&(e[a]=this[a])}return e}}()});return l.beforeFrame=function(){o=0},l.POINTS=a.POINTS,l.LINES=a.LINES,l.LINE_LOOP=a.LINE_LOOP,l.LINE_STRIP=a.LINE_STRIP,l.TRIANGLES=a.TRIANGLES,l.TRIANGLE_STRIP=a.TRIANGLE_STRIP,l.TRIANGLE_FAN=a.TRIANGLE_FAN,l.BACK=a.BACK,l.FRONT=a.FRONT,l.FRONT_AND_BACK=a.FRONT_AND_BACK,l.CW=a.CW,l.CCW=a.CCW,l.RenderInfo=c,l}),define("qtek/core/glinfo",[],function(){"use strict";var t=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","WEBGL_draw_buffers"],e={},r={initialize:function(r){if(!e[r.__GLID__]){e[r.__GLID__]={};for(var i=0;t.length>i;i++){var a=t[i];this._createExtension(r,a)}}},getExtension:function(t,r){var i=t.__GLID__;return e[i]?(e[i][r]===void 0&&this._createExtension(t,r),e[i][r]):void 0},dispose:function(t){delete e[t.__GLID__]},_createExtension:function(t,r){var i=t.getExtension(r);i||(i=t.getExtension("MOZ_"+r)),i||(i=t.getExtension("WEBKIT_"+r)),e[t.__GLID__][r]=i}};return r}),define("qtek/DynamicGeometry",["require","./Geometry","./math/BoundingBox","./core/glenum","./core/glinfo","./dep/glmatrix"],function(t){"use strict";var e=t("./Geometry"),r=t("./math/BoundingBox"),i=t("./core/glenum"),a=t("./core/glinfo"),n=t("./dep/glmatrix"),s=n.vec3,o=n.mat4,u=Array.prototype.slice,h=e.derive(function(){return{attributes:{position:new e.Attribute("position","float",3,"POSITION",!0),texcoord0:new e.Attribute("texcoord0","float",2,"TEXCOORD_0",!0),texcoord1:new e.Attribute("texcoord1","float",2,"TEXCOORD_1",!0),normal:new e.Attribute("normal","float",3,"NORMAL",!0),tangent:new e.Attribute("tangent","float",4,"TANGENT",!0),color:new e.Attribute("color","float",4,"COLOR",!0),weight:new e.Attribute("weight","float",3,"WEIGHT",!0),joint:new e.Attribute("joint","float",4,"JOINT",!0),barycentric:new e.Attribute("barycentric","float",3,null,!0)},dynamic:!0,hint:i.DYNAMIC_DRAW,faces:[],_enabledAttributes:null,_arrayChunks:[]}},{updateBoundingBox:function(){this.boundingBox||(this.boundingBox=new r),this.boundingBox.updateFromVertices(this.attributes.position.value)},dirty:function(t){if(t)this._cache.dirtyAll(t),this._cache.dirtyAll(),this._enabledAttributes=null;else{this.dirty("indices");for(var e in this.attributes)this.dirty(e)}},getVertexNumber:function(){var t=this.attributes[this.mainAttribute];return t&&t.value?t.value.length:0},getFaceNumber:function(){return this.faces.length},getFace:function(t,e){return this.getFaceNumber()>t&&t>=0?(e||(e=s.create()),s.copy(e,this.faces[t]),e):void 0},isUseFace:function(){return this.useFace&&this.faces.length>0},isSplitted:function(){return this.getVertexNumber()>65535},createAttribute:function(t,r,i,a){var n=new e.Attribute(t,r,i,a,!0);return this.attributes[t]=n,this._attributeList.push(t),n},removeAttribute:function(t){var e=this._attributeList.indexOf(t);return e>=0?(this._attributeList.splice(e,1),delete this.attributes[t],!0):!1},getEnabledAttributes:function(){if(this._enabledAttributes)return this._enabledAttributes;for(var t={},e=this.getVertexNumber(),r=0;this._attributeList.length>r;r++){var i=this._attributeList[r],a=this.attributes[i];a.value.length&&a.value.length===e&&(t[i]=a)}return this._enabledAttributes=t,t},_getDirtyAttributes:function(){var t=this.getEnabledAttributes();if(this._cache.miss("chunks"))return t;var e={},r=!0;for(var i in t)this._cache.isDirty(i)&&(e[i]=t[i],r=!1);return r?void 0:e},getChunkNumber:function(){return this._arrayChunks.length},getBufferChunks:function(t){if(this._cache.use(t.__GLID__),this._cache.isDirty()){var e=this._getDirtyAttributes(),r=this._cache.isDirty("indices");if(r=r&&this.isUseFace(),e){this._updateAttributesAndIndicesArrays(e,r,null!=a.getExtension(t,"OES_element_index_uint")),this._updateBuffer(t,e,r);for(var i in e)this._cache.fresh(i);this._cache.fresh("indices"),this._cache.fresh()}}return this._cache.get("chunks")},_updateAttributesAndIndicesArrays:function(t,e,r){var i=this,a=this.getVertexNumber(),n=[],s=[],o={};for(var u in t)switch(D){case"byte":o[u]=Int8Array;break;case"ubyte":o[u]=Uint8Array;break;case"short":o[u]=Int16Array;break;case"ushort":o[u]=Uint16Array;break;default:o[u]=Float32Array}var h=function(e){if(i._arrayChunks[e])return i._arrayChunks[e];var r={attributeArrays:{},indicesArray:null};for(var s in t)r.attributeArrays[s]=null;for(var o=0;a>o;o++)n[o]=-1;return i._arrayChunks.push(r),r},c=Object.keys(t);if(a>65535&&this.isUseFace()&&!r){var l,_=0,f=[0],d=[];for(y=0;a>y;y++)d[y]=-1,n[y]=-1;if(e)for(y=0;this.faces.length>y;y++)s[y]=[0,0,0];l=h(_);for(var m=0,y=0;this.faces.length>y;y++){var p=this.faces[y],v=s[y];m+3>65535&&(_++,f[_]=y,m=0,l=h(_));for(var g=0;3>g;g++){for(var E=p[g],T=-1===n[E],b=0;c.length>b;b++){var u=c[b],x=l.attributeArrays[u],R=t[u].value,A=t[u].size;if(x||(x=l.attributeArrays[u]=[]),T){1===A&&(x[m]=R[E]);for(var S=0;A>S;S++)x[m*A+S]=R[E][S]}}T?(n[E]=m,v[g]=m,m++):v[g]=n[E]}}for(var N=0;this._arrayChunks.length>N;N++){var I=this._arrayChunks[N];for(var u in I.attributeArrays){var M=I.attributeArrays[u];M instanceof Array&&(I.attributeArrays[u]=new o[u](M))}}if(e)for(var P,L,w,I,N=0;this._arrayChunks.length>N;N++){P=f[N],L=f[N+1]||this.faces.length,w=0,I=this._arrayChunks[N];var O=I.indicesArray;O||(O=I.indicesArray=new Uint16Array(3*(L-P)));for(var y=P;L>y;y++)O[w++]=s[y][0],O[w++]=s[y][1],O[w++]=s[y][2]}}else{var I=h(0);if(e){var O=I.indicesArray,k=this.faces.length;if(!O||3*k!==O.length){var C=a>65535?Uint32Array:Uint16Array;O=I.indicesArray=new C(3*this.faces.length)}for(var w=0,y=0;k>y;y++)O[w++]=this.faces[y][0],O[w++]=this.faces[y][1],O[w++]=this.faces[y][2]}for(var u in t){var R=t[u].value,D=t[u].type,A=t[u].size,x=I.attributeArrays[u],B=a*A;if(x&&x.length===B||(x=new o[u](B),I.attributeArrays[u]=x),1===A)for(var y=0;R.length>y;y++)x[y]=R[y];else for(var w=0,y=0;R.length>y;y++)for(var S=0;A>S;S++)x[w++]=R[y][S]}}},_updateBuffer:function(t,r,i){var a=this._cache.get("chunks"),n=!1;if(!a){a=[];for(var s=0;this._arrayChunks.length>s;s++)a[s]={attributeBuffers:[],indicesBuffer:null};this._cache.put("chunks",a),n=!0}for(var o=0;this._arrayChunks.length>o;o++){var u=a[o];u||(u=a[o]={attributeBuffers:[],indicesBuffer:null});var h=u.attributeBuffers,c=u.indicesBuffer,l=this._arrayChunks[o],_=l.attributeArrays,f=l.indicesArray,d=0,m=0;for(var y in r){var p,v=r[y],g=v.type,E=v.semantic,T=v.size;if(!n){for(var s=m;h.length>s;s++)if(h[s].name===y){p=h[s],m=s+1;break}if(!p)for(var s=m-1;s>=0;s--)if(h[s].name===y){p=h[s],m=s;break}}var b;b=p?p.buffer:t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,b),t.bufferData(t.ARRAY_BUFFER,_[y],this.hint),h[d++]=new e.AttributeBuffer(y,g,b,T,E)}h.length=d,i&&(c||(c=new e.IndicesBuffer(t.createBuffer()),u.indicesBuffer=c),c.count=f.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,f,this.hint))}},generateVertexNormals:function(){for(var t=this.faces,e=t.length,r=this.attributes.position.value,i=this.attributes.normal.value,a=s.create(),n=s.create(),o=s.create(),u=0;i.length>u;u++)s.set(i[u],0,0,0);for(var u=i.length;r.length>u;u++)i[u]=[0,0,0];for(var h=0;e>h;h++){var c=t[h],l=c[0],_=c[1],f=c[2],d=r[l],m=r[_],y=r[f];s.sub(n,d,m),s.sub(o,m,y),s.cross(a,n,o),s.add(i[l],i[l],a),s.add(i[_],i[_],a),s.add(i[f],i[f],a)}for(var u=0;i.length>u;u++)s.normalize(i[u],i[u])},generateFaceNormals:function(){this.isUniqueVertex()||this.generateUniqueVertex();for(var t=this.faces,e=t.length,r=this.attributes.position.value,i=this.attributes.normal.value,a=s.create(),n=s.create(),o=s.create(),h=i.length===r.length,c=0;e>c;c++){var l=t[c],_=l[0],f=l[1],d=l[2],m=r[_],y=r[f],p=r[d];s.sub(n,m,y),s.sub(o,y,p),s.cross(a,n,o),h?(s.copy(i[_],a),s.copy(i[f],a),s.copy(i[d],a)):i[_]=i[f]=i[d]=u.call(a)}},generateTangents:function(){for(var t=this.attributes.texcoord0.value,e=this.attributes.position.value,r=this.attributes.tangent.value,i=this.attributes.normal.value,a=[],n=[],o=this.getVertexNumber(),u=0;o>u;u++)a[u]=[0,0,0],n[u]=[0,0,0];for(var h=[0,0,0],c=[0,0,0],u=0;this.faces.length>u;u++){var l=this.faces[u],_=l[0],f=l[1],d=l[2],m=t[_],y=t[f],p=t[d],v=e[_],g=e[f],E=e[d],T=g[0]-v[0],b=E[0]-v[0],x=g[1]-v[1],R=E[1]-v[1],A=g[2]-v[2],S=E[2]-v[2],N=y[0]-m[0],I=p[0]-m[0],M=y[1]-m[1],P=p[1]-m[1],L=1/(N*P-M*I);h[0]=(P*T-M*b)*L,h[1]=(P*x-M*R)*L,h[2]=(P*A-M*S)*L,c[0]=(N*b-I*T)*L,c[1]=(N*R-I*x)*L,c[2]=(N*S-I*A)*L,s.add(a[_],a[_],h),s.add(a[f],a[f],h),s.add(a[d],a[d],h),s.add(n[_],n[_],c),s.add(n[f],n[f],c),s.add(n[d],n[d],c)}for(var w=[0,0,0,0],O=[0,0,0],u=0;o>u;u++){var k=i[u],C=a[u];s.scale(w,k,s.dot(k,C)),s.sub(w,C,w),s.normalize(w,w),s.cross(O,k,C),w[3]=0>s.dot(O,n[u])?-1:1,r[u]=w.slice()}},isUniqueVertex:function(){return this.isUseFace()?this.getVertexNumber()===3*this.faces.length:!0},generateUniqueVertex:function(){for(var t=[],e=0;this.getVertexNumber()>e;e++)t[e]=0;for(var r=this.getVertexNumber(),i=this.getEnabledAttributes(),a=this.faces,n=Object.keys(i),e=0;a.length>e;e++)for(var s=a[e],o=0;3>o;o++){var h=s[o];if(t[h]>0){for(var c=0;n.length>c;c++){var l=n[c],_=i[l].value,f=i[l].size;1===f?_.push(_[h]):_.push(u.call(_[h]))}s[o]=r,r++}t[h]++}this.dirty()},generateBarycentric:function(){var t=[1,0,0],e=[0,0,1],r=[0,1,0];return function(){this.isUniqueVertex()||this.generateUniqueVertex();var i=this.attributes.barycentric.value;if(i.length!=3*this.faces.length)for(var a,n,s,o,u=0;this.faces.length>u;u++)o=this.faces[u],a=o[0],n=o[1],s=o[2],i[a]=t,i[n]=e,i[s]=r}}(),convertToStatic:function(t,e){if(this._updateAttributesAndIndicesArrays(this.getEnabledAttributes(),!0,e),this._arrayChunks.length>1)console.warn("Large geometry will discard chunks when convert to StaticGeometry");else if(0===this._arrayChunks.length)return t;var i=this._arrayChunks[0],a=this.getEnabledAttributes();for(var n in a){var s=a[n],o=t.attributes[n];o||(o=t.attributes[n]={type:s.type,size:s.size,value:null},s.semantic&&(o.semantic=s.semantic)),o.value=i.attributeArrays[n]}return t.faces=i.indicesArray,this.boundingBox&&(t.boundingBox=new r,t.boundingBox.min.copy(this.boundingBox.min),t.boundingBox.max.copy(this.boundingBox.max)),t},applyTransform:function(t){this.boundingBox&&this.boundingBox.applyTransform(t);var e=this.attributes.position.value,r=this.attributes.normal.value,i=this.attributes.tangent.value;t=t._array;for(var a=0;e.length>a;a++)s.transformMat4(e[a],e[a],t);var n=o.create();o.invert(n,t),o.transpose(n,n);for(var a=0;r.length>a;a++)s.transformMat4(r[a],r[a],n);for(var a=0;i.length>a;a++)s.transformMat4(i[a],i[a],n)},dispose:function(t){this._cache.use(t.__GLID__);var e=this._cache.get("chunks");if(e)for(var r=0;e.length>r;r++)for(var i=e[r],a=0;i.attributeBuffers.length>a;a++){var n=i.attributeBuffers[a];t.deleteBuffer(n.buffer)}this._cache.deleteContext(t.__GLID__)}});return h}),define("qtek/Geometry",["require","./core/Base","./core/glenum","./core/Cache","./dep/glmatrix"],function(t){"use strict";function e(t,e,r,i,a){switch(this.name=t,this.type=e,this.size=r,i&&(this.semantic=i),a?(this._isDynamic=!0,this.value=[]):(this._isDynamic=!1,this.value=null),r){case 1:this.get=function(t){return this.value[t]},this.set=function(t,e){this.value[t]=e};break;case 2:a?(this.get=function(t,e){e=e._array||e;var r=this.value[t];return r&&h.copy(e,r),e},this.set=function(t,e){e=e._array||e;var r=this.value[t];r||(r=this.value[t]=h.create()),h.copy(r,e)}):(this.get=function(t,e){return e=e._array||e,e[0]=this.value[2*t],e[1]=this.value[2*t+1],e},this.set=function(t,e){e=e._array||e,this.value[2*t]=e[0],this.value[2*t+1]=e[1]});break;case 3:a?(this.get=function(t,e){e=e._array||e;var r=this.value[t];return r&&c.copy(e,r),e},this.set=function(t,e){e=e._array||e;var r=this.value[t];r||(r=this.value[t]=c.create()),c.copy(r,e)}):(this.get=function(t,e){return e=e._array||e,e[0]=this.value[3*t],e[1]=this.value[3*t+1],e[2]=this.value[3*t+2],e},this.set=function(t,e){e=e._array||e,this.value[3*t]=e[0],this.value[3*t+1]=e[1],this.value[3*t+2]=e[2]});break;case 4:a?(this.get=function(t,e){e=e._array||e;var r=this.value[t];return r&&l.copy(e,r),e},this.set=function(t,e){e=e._array||e;var r=this.value[t];r||(r=this.value[t]=l.create()),l.copy(r,e)}):(this.get=function(t,e){return e=e._array||e,e[0]=this.value[4*t],e[1]=this.value[4*t+1],e[2]=this.value[4*t+2],e[3]=this.value[4*t+3],e},this.set=function(t,e){e=e._array||e,this.value[4*t]=e[0],this.value[4*t+1]=e[1],this.value[4*t+2]=e[2],this.value[4*t+3]=e[3]})}}function r(t,e,r,i,a){this.name=t,this.type=e,this.buffer=r,this.size=i,this.semantic=a,this.symbol=""}function i(t){this.buffer=t,this.count=0}function a(){console.warn("Geometry doesn't implement this method, use DynamicGeometry or StaticGeometry instead")}var n=t("./core/Base"),s=t("./core/glenum"),o=t("./core/Cache"),u=t("./dep/glmatrix"),h=u.vec2,c=u.vec3,l=u.vec4;e.prototype.init=function(t){if(this._isDynamic)console.warn("Dynamic geometry not support init method");else if(!this.value||this.value.length!=t*this.size){var e;switch(this.type){case"byte":e=Int8Array;break;case"ubyte":e=Uint8Array;break;case"short":e=Int16Array;break;case"ushort":e=Uint16Array;break;default:e=Float32Array}this.value=new e(t*this.size)}},e.prototype.clone=function(t){var r=new e(this.name,this.type,this.size,this.semantic,this._isDynamic);return t&&console.warn("todo"),r};var _=n.derive({boundingBox:null,attributes:{},faces:null,dynamic:!1,useFace:!0},function(){this._cache=new o,this._attributeList=Object.keys(this.attributes)},{mainAttribute:"position",dirty:a,createAttribute:a,removeAttribute:a,getVertexNumber:a,getFaceNumber:a,getFace:a,isUseFace:a,getEnabledAttributes:a,getBufferChunks:a,generateVertexNormals:a,generateFaceNormals:a,isUniqueVertex:a,generateUniqueVertex:a,generateTangents:a,generateBarycentric:a,applyTransform:a,dispose:a});return _.STATIC_DRAW=s.STATIC_DRAW,_.DYNAMIC_DRAW=s.DYNAMIC_DRAW,_.STREAM_DRAW=s.STREAM_DRAW,_.AttributeBuffer=r,_.IndicesBuffer=i,_.Attribute=e,_}),define("qtek/math/BoundingBox",["require","./Vector3","../dep/glmatrix"],function(t){"use strict";var e=t("./Vector3"),r=t("../dep/glmatrix"),i=r.vec3,a=i.transformMat4,n=i.copy,s=i.set,o=function(t,r){this.min=t||new e(1/0,1/0,1/0),this.max=r||new e(-1/0,-1/0,-1/0);for(var a=[],n=0;8>n;n++)a[n]=i.fromValues(0,0,0);this.vertices=a};return o.prototype={constructor:o,updateFromVertices:function(t){if(t.length>0){var e=this.min._array,r=this.max._array;n(e,t[0]),n(r,t[0]);for(var i=1;t.length>i;i++){var a=t[i];a[0]<e[0]&&(e[0]=a[0]),a[1]<e[1]&&(e[1]=a[1]),a[2]<e[2]&&(e[2]=a[2]),a[0]>r[0]&&(r[0]=a[0]),a[1]>r[1]&&(r[1]=a[1]),a[2]>r[2]&&(r[2]=a[2])}this.min._dirty=!0,this.max._dirty=!0}},union:function(t){i.min(this.min._array,this.min._array,t.min._array),i.max(this.max._array,this.max._array,t.max._array),this.min._dirty=!0,this.max._dirty=!0},intersectBoundingBox:function(t){var e=this.min._array,r=this.max._array,i=t.min._array,a=t.max._array;return!(e[0]>a[0]||e[1]>a[1]||e[2]>a[1]||r[0]<i[0]||r[1]<i[1]||r[2]<i[2])},applyTransform:function(t){(this.min._dirty||this.max._dirty)&&(this.updateVertices(),this.min._dirty=!1,this.max._dirty=!1);var e=t._array,r=this.min._array,i=this.max._array,s=this.vertices,o=s[0];a(o,o,e),n(r,o),n(i,o);for(var u=1;8>u;u++)o=s[u],a(o,o,e),o[0]<r[0]&&(r[0]=o[0]),o[1]<r[1]&&(r[1]=o[1]),o[2]<r[2]&&(r[2]=o[2]),o[0]>i[0]&&(i[0]=o[0]),o[1]>i[1]&&(i[1]=o[1]),o[2]>i[2]&&(i[2]=o[2]);this.min._dirty=!0,this.max._dirty=!0},applyProjection:function(t){(this.min._dirty||this.max._dirty)&&(this.updateVertices(),this.min._dirty=!1,this.max._dirty=!1);var e=t._array,r=this.vertices[0],i=this.vertices[3],a=this.vertices[7],n=this.min._array,s=this.max._array;if(1===e[15])n[0]=e[0]*r[0]+e[12],n[1]=e[5]*r[1]+e[13],s[2]=e[10]*r[2]+e[14],s[0]=e[0]*a[0]+e[12],s[1]=e[5]*a[1]+e[13],n[2]=e[10]*a[2]+e[14];else{var o=-1/r[2];n[0]=e[0]*r[0]*o,n[1]=e[5]*r[1]*o,s[2]=(e[10]*r[2]+e[14])*o,o=-1/i[2],s[0]=e[0]*i[0]*o,s[1]=e[5]*i[1]*o,o=-1/a[2],n[2]=(e[10]*a[2]+e[14])*o}this.min._dirty=!0,this.max._dirty=!0},updateVertices:function(){var t=this.min._array,e=this.max._array,r=this.vertices;s(r[0],t[0],t[1],t[2]),s(r[1],t[0],e[1],t[2]),s(r[2],e[0],t[1],t[2]),s(r[3],e[0],e[1],t[2]),s(r[4],t[0],t[1],e[2]),s(r[5],t[0],e[1],e[2]),s(r[6],e[0],t[1],e[2]),s(r[7],e[0],e[1],e[2])},copy:function(t){n(this.min._array,t.min._array),n(this.max._array,t.max._array),this.min._dirty=!0,this.max._dirty=!0},clone:function(){var t=new o;return t.copy(this),t}},o}),define("qtek/Texture",["require","./core/Base","./core/glenum","./core/Cache"],function(t){"use strict";var e=t("./core/Base"),r=t("./core/glenum"),i=t("./core/Cache"),a=e.derive({width:512,height:512,type:r.UNSIGNED_BYTE,format:r.RGBA,wrapS:r.CLAMP_TO_EDGE,wrapT:r.CLAMP_TO_EDGE,minFilter:r.LINEAR_MIPMAP_LINEAR,magFilter:r.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1},function(){this._cache=new i},{getWebGLTexture:function(t){var e=this._cache;return e.use(t.__GLID__),e.miss("webgl_texture")&&e.put("webgl_texture",t.createTexture()),this.dynamic?this.update(t):e.isDirty()&&(this.update(t),e.fresh()),e.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache.dirtyAll()},update:function(){},beforeUpdate:function(t){t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.fallBack()},fallBack:function(){var t=this.isPowerOfTwo();this.format===r.DEPTH_COMPONENT&&(this.useMipmap=!1),t&&this.useMipmap?(this.NPOT=!1,this._minFilterOriginal&&(this.minFilter=this._minFilterOriginal),this._magFilterOriginal&&(this.magFilter=this._magFilterOriginal),this._wrapSOriginal&&(this.wrapS=this._wrapSOriginal),this._wrapTOriginal&&(this.wrapT=this._wrapTOriginal)):(this.NPOT=!0,this._minFilterOriginal=this.minFilter,this._magFilterOriginal=this.magFilter,this._wrapSOriginal=this.wrapS,this._wrapTOriginal=this.wrapT,this.minFilter==r.NEAREST_MIPMAP_NEAREST||this.minFilter==r.NEAREST_MIPMAP_LINEAR?this.minFilter=r.NEAREST:(this.minFilter==r.LINEAR_MIPMAP_LINEAR||this.minFilter==r.LINEAR_MIPMAP_NEAREST)&&(this.minFilter=r.LINEAR),this.wrapS=r.CLAMP_TO_EDGE,this.wrapT=r.CLAMP_TO_EDGE)},nextHighestPowerOfTwo:function(t){--t;for(var e=1;32>e;e<<=1)t|=t>>e;return t+1},dispose:function(t){var e=this._cache;e.use(t.__GLID__);var r=e.get("webgl_texture");r&&t.deleteTexture(r),e.deleteContext(t.__GLID__)},isRenderable:function(){},isPowerOfTwo:function(){}});return a.BYTE=r.BYTE,a.UNSIGNED_BYTE=r.UNSIGNED_BYTE,a.SHORT=r.SHORT,a.UNSIGNED_SHORT=r.UNSIGNED_SHORT,a.INT=r.INT,a.UNSIGNED_INT=r.UNSIGNED_INT,a.FLOAT=r.FLOAT,a.HALF_FLOAT=36193,a.DEPTH_COMPONENT=r.DEPTH_COMPONENT,a.ALPHA=r.ALPHA,a.RGB=r.RGB,a.RGBA=r.RGBA,a.LUMINANCE=r.LUMINANCE,a.LUMINANCE_ALPHA=r.LUMINANCE_ALPHA,a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,a.NEAREST=r.NEAREST,a.LINEAR=r.LINEAR,a.NEAREST_MIPMAP_NEAREST=r.NEAREST_MIPMAP_NEAREST,a.LINEAR_MIPMAP_NEAREST=r.LINEAR_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR=r.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_LINEAR=r.LINEAR_MIPMAP_LINEAR,a.TEXTURE_MAG_FILTER=r.TEXTURE_MAG_FILTER,a.TEXTURE_MIN_FILTER=r.TEXTURE_MIN_FILTER,a.REPEAT=r.REPEAT,a.CLAMP_TO_EDGE=r.CLAMP_TO_EDGE,a.MIRRORED_REPEAT=r.MIRRORED_REPEAT,a}),define("echarts-x/component/base3d",["require","echarts/component/base","../core/Layer3D","zrender/tool/util"],function(t){"use strict";var e=t("echarts/component/base"),r=t("../core/Layer3D"),i=t("zrender/tool/util"),a=function(t,i,a,n,s){e.call(this,t,i,a,n,s);var o=this.getZlevelBase();this.baseLayer=new r(o,this.zr.painter),this.zr.painter.insertLayer(o,this.baseLayer),this.zr.animation.bind("frame",this.onframe,this)};return a.prototype={constructor:a,onframe:function(){},dispose:function(){this.zr.animation.unbind("frame",this.onframe)}},i.inherits(a,e),a}),define("echarts-x/util/color",[],function(){function t(t){return t=Math.round(t),0>t?0:t>255?255:t}function e(t){return 0>t?0:t>1?1:t}function r(e){return"%"===e[e.length-1]?t(255*(parseFloat(e)/100)):t(parseInt(e))}function i(t){return"%"===t[t.length-1]?e(parseFloat(t)/100):e(parseFloat(t))}function a(t,e,r){return 0>r?r+=1:r>1&&(r-=1),1>6*r?t+6*(e-t)*r:1>2*r?e:2>3*r?t+6*(e-t)*(2/3-r):t}function n(e){var n=e.replace(/ /g,"").toLowerCase();if(n in s)return s[n].slice();if("#"===n[0]){if(4===n.length){var o=parseInt(n.substr(1),16);return o>=0&&4095>=o?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null}if(7===n.length){var o=parseInt(n.substr(1),16);return o>=0&&16777215>=o?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null}return null}var u=n.indexOf("("),h=n.indexOf(")");if(-1!==u&&h+1===n.length){var c=n.substr(0,u),l=n.substr(u+1,h-(u+1)).split(","),_=1;switch(c){case"rgba":if(4!==l.length)return null;_=i(l.pop());case"rgb":return 3!==l.length?null:[r(l[0]),r(l[1]),r(l[2]),_];case"hsla":if(4!==l.length)return null;_=i(l.pop());case"hsl":if(3!==l.length)return null;var f=(parseFloat(l[0])%360+360)%360/360,d=i(l[1]),m=i(l[2]),y=.5>=m?m*(d+1):m+d-m*d,p=2*m-y;return[t(255*a(p,y,f+1/3)),t(255*a(p,y,f)),t(255*a(p,y,f-1/3)),_];default:return null}}return null}var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};return{parse:n}}),define("echarts-x/entity/marker/MarkLine",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","../../util/geometry/Lines","../../util/geometry/CurveAnimatingPoints","qtek/Texture2D","qtek/math/Vector3"],function(t){var e=t("zrender/tool/util"),r=t("./Base"),i=t("qtek/Renderable"),a=t("qtek/Material"),n=t("qtek/Shader"),s=t("qtek/Node"),o=t("../../util/geometry/Lines"),u=t("../../util/geometry/CurveAnimatingPoints");t("qtek/Texture2D");var h=t("qtek/math/Vector3"),c=function(t){r.call(this,t),this._sceneNode=new s,this._markLineRenderable=null,this._curveAnimatingPointsRenderable=null,this._elapsedTime=0};return c.prototype={constructor:c,_createMarkLineRenderable:function(){var t=new a({shader:new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")}),transparent:!0,depthMask:!1});t.shader.define("both","VERTEX_COLOR"),this._markLineRenderable=new i({geometry:new o,material:t,mode:i.LINES}),this._sceneNode.add(this._markLineRenderable)},_createCurveAnimatingPointsRenderable:function(){var t=new a({shader:new n({vertex:n.source("ecx.curveAnimatingPoints.vertex"),fragment:n.source("ecx.curveAnimatingPoints.fragment")})});this._curveAnimatingPointsRenderable=new i({material:t,mode:i.POINTS,geometry:new u}),this._sceneNode.add(this._curveAnimatingPointsRenderable)},setSeries:function(t,e){if(t.markLine&&t.markLine.data){this.seriesIndex=e;var r=this.chart,i=r.component.legend;r.zr;var a=t.markLine,n=window.devicePixelRatio||1;this._markLineRenderable||this._createMarkLineRenderable();var s=r.query(a,"itemStyle.normal.lineStyle.width"),o=r.query(a,"itemStyle.normal.lineStyle.opacity"),u=this._markLineRenderable;u.lineWidth=s*n,u.material.set("alpha",o);var c,l=r.query(t.markLine,"effect.show");if(l){var _=r.query(a,"effect.scaleSize");this._curveAnimatingPointsRenderable||this._createCurveAnimatingPointsRenderable(),c=this._curveAnimatingPointsRenderable,c.material.set("pointSize",_*n),c.geometry.dirty()}var f;i&&(f=i.getColor(t.name)),f=r.query(a,"itemStyle.normal.color");for(var d=r.zr.getColor(e),m=a.data,y=0;m.length>y;y++){var p=new h,v=new h,g=new h,E=new h,T=m[y],b=r.query(T,"itemStyle.normal.color"),x=b||f||d;"function"==typeof x&&(x=x(T));var R=r.parseColor(x)||new Float32Array;r.getMarkLinePoints(e,T,p,v,g,E),u.geometry.addCubicCurve(p,v,g,E,R),l&&c.geometry.addPoint(p,v,g,E,R)}u.geometry.dirty()}},clear:function(){this._elapsedTime=0,this._markLineRenderable&&this._markLineRenderable.geometry.clearLines(),this._curveAnimatingPointsRenderable&&this._curveAnimatingPointsRenderable.geometry.clearPoints()},getSceneNode:function(){return this._sceneNode},onframe:function(t){var e=this._curveAnimatingPointsRenderable;if(e&&e.geometry.getVertexNumber()>0){this._elapsedTime+=t/1e3;var r=this._elapsedTime/3;r%=1,e.material.set("percent",r),this.chart.zr.refreshNextFrame()}}},e.inherits(c,r),c}),define("echarts-x/entity/marker/MarkBar",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","../../util/geometry/Bars","qtek/math/Vector3"],function(t){var e=t("zrender/tool/util"),r=t("./Base"),i=t("qtek/Renderable"),a=t("qtek/Material"),n=t("qtek/Shader"),s=t("../../util/geometry/Bars"),o=t("qtek/math/Vector3"),u=function(t){r.call(this,t),this._markBarRenderable=null};return u.prototype={constructor:u,_createMarkBarRenderable:function(){var t=new a({shader:new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")})});t.shader.define("both","VERTEX_COLOR"),this._markBarRenderable=new i({geometry:new s,material:t,ignorePicking:!0})},setSeries:function(t,e){if(t.markBar&&t.markBar.data){var r=this.chart,i=r.component,a=i.legend,n=i.dataRange;this._markBarRenderable||this._createMarkBarRenderable();var s=t.markBar.data;this._markBarRenderable.geometry;var u;a&&(u=a.getColor(t.name)),u=r.query(t.markBar,"itemStyle.normal.color")||u;var h=r.zr.getColor(e),c=new o,l=new o;new o;for(var _=t.markBar.barSize,f=0;s.length>f;f++){var d=s[f],m=r.getDataFromOption(d,null),y=null;if(!n||(y=isNaN(m)?v:n.getColor(m),null!=y)){var p=r.query(d,"itemStyle.normal.color"),v=p||y||u||h;"function"==typeof v&&(v=v(d));var g=r.parseColor(v)||new Float32Array,E=null!=d.barSize?d.barSize:_;"function"==typeof E&&(E=E(d)),r.getMarkBarPoints(e,d,c,l),this._markBarRenderable.geometry.addBar(c,l,E,g)}}this._markBarRenderable.geometry.dirty()}},getSceneNode:function(){return this._markBarRenderable},clear:function(){this._markBarRenderable&&this._markBarRenderable.geometry.clearBars()}},e.inherits(u,r),u}),define("echarts-x/entity/marker/MarkPoint",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","qtek/Texture2D","qtek/Texture","../../surface/TextureAtlasSurface","../../util/geometry/Sprites","../../util/sprite","echarts/util/shape/Icon","zrender/shape/Image","qtek/math/Matrix4"],function(t){var e=t("zrender/tool/util"),r=t("./Base"),i=t("qtek/Renderable"),a=t("qtek/Material"),n=t("qtek/Shader"),s=t("qtek/Node");t("qtek/Texture2D");var o=t("qtek/Texture"),u=t("../../surface/TextureAtlasSurface"),h=t("../../util/geometry/Sprites");t("../../util/sprite");var c=t("echarts/util/shape/Icon"),l=t("zrender/shape/Image"),_=t("qtek/math/Matrix4"),f=function(t){r.call(this,t),this._sceneNode=new s,this._spritesRenderables=[],this._spritesShader=null,this._textureAtlasList=[],this._spriteSize=128};return f.prototype={constructor:f,setSeries:function(t,e){if(t.markPoint&&t.markPoint.data&&0!==t.markPoint.data.length){this.seriesIndex=e;
var r=this.chart,i=r.component,a=i.legend,n=i.dataRange,s=t.markPoint;r.zr;var h,f=this._spriteSize,d=s.data;a&&(h=a.getColor(t.name)),h=r.query(t.markBar,"itemStyle.normal.color")||h;var m=r.zr.getColor(e),y=new _,p=o.prototype.nextHighestPowerOfTwo(Math.sqrt(d.length)*this._spriteSize);p=Math.min(2048,p);var v=new u(r.zr,p,p);this._textureAtlasList.push(v);for(var g=this._createSpritesRenderable(v),E=0;d.length>E;E++){var T=d[E],b=r.getDataFromOption(T,null),x=[T,s],R=null;if(!n||(R=isNaN(b)?S:n.getColor(b),null!=R)){var A=r.query(T,"itemStyle.normal.color"),S=A||R||h||m;"function"==typeof S&&(S=S(T));var N,I=r.deepQuery(x,"symbol"),M=r.deepQuery(x,"symbolSize"),P=r.deepQuery(x,"itemStyle.normal.borderColor"),L=r.deepQuery(x,"itemStyle.normal.borderWidth");N=I.match(/^image:\/\//)?new l({style:{image:I.replace(/^image:\/\//,"")}}):new c({style:{iconType:I,color:S,brushType:"both",strokeColor:P,lineWidth:L/M*f}});var w=N.style;w.x=w.y=0,w.width=w.height=f,r.deepQuery(x,"itemStyle.normal.label.show")&&(N.style.text=r.getSerieLabelText(s,T,T.name,"normal"),N.style.textPosition="inside",N.style.textColor=r.deepQuery(x,"itemStyle.normal.label.textStyle.color"),N.style.textFont=r.getFont(r.deepQuery(x,"itemStyle.normal.label.textStyle")));var O=v.addShape(N,f,f);O||(v=new u(r.zr,p,p),this._textureAtlasList.push(v),g=this._createSpritesRenderable(v),O=v.addShape(N,f,f)),r.getMarkPointTransform(e,T,y),g.geometry.addSprite(y,O)}}for(var E=0;this._textureAtlasList.length>E;E++)this._textureAtlasList[E].refresh()}},_createSpritesRenderable:function(t){this._spritesShader||(this._spritesShader=new n({vertex:n.source("ecx.albedo.vertex"),fragment:n.source("ecx.albedo.fragment")}),this._spritesShader.enableTexture("diffuseMap"));var e=new i({material:new a({shader:this._spritesShader,transparent:!0,depthMask:!1}),culling:!1,geometry:new h,ignorePicking:!0});return e.material.set("diffuseMap",t.getTexture()),this._spritesRenderables.push(e),this._sceneNode.add(e),e},clear:function(){var t=this.chart.baseLayer.renderer;t.disposeNode(this._sceneNode,!0,!0),this._sceneNode=new s,this._spritesRenderables=[],this._textureAtlasList=[]},getSceneNode:function(){return this._sceneNode}},e.inherits(f,r),f}),define("echarts-x/entity/marker/LargeMarkPoint",["require","zrender/tool/util","./Base","qtek/Renderable","qtek/Material","qtek/Shader","qtek/Node","../../util/geometry/Points","../../util/geometry/AnimatingPoints","qtek/Texture2D","../../util/sprite","qtek/math/Vector3","echarts/util/shape/Icon"],function(t){var e=t("zrender/tool/util"),r=t("./Base"),i=t("qtek/Renderable"),a=t("qtek/Material"),n=t("qtek/Shader"),s=t("qtek/Node"),o=t("../../util/geometry/Points"),u=t("../../util/geometry/AnimatingPoints"),h=t("qtek/Texture2D"),c=t("../../util/sprite"),l=t("qtek/math/Vector3"),_=t("echarts/util/shape/Icon"),f=function(t){r.call(this,t),this._sceneNode=new s,this._markPointRenderable=null,this._animatingMarkPointRenderable=null,this._spriteTexture=null,this._elapsedTime=0};return f.prototype={constructor:f,_createMarkPointRenderable:function(){var t=new a({shader:new n({vertex:n.source("ecx.points.vertex"),fragment:n.source("ecx.points.fragment")}),depthMask:!1,transparent:!0});t.shader.enableTexture("sprite"),this._markPointRenderable=new i({geometry:new o,material:t,mode:i.POINTS}),this._spriteTexture&&t.set("sprite",this._spriteTexture),this._sceneNode.add(this._markPointRenderable)},_createAnimatingMarkPointRenderable:function(){var t=new a({shader:new n({vertex:n.source("ecx.points.vertex"),fragment:n.source("ecx.points.fragment")}),depthMask:!1,transparent:!0});t.shader.enableTexture("sprite"),t.shader.define("vertex","ANIMATING"),this._animatingMarkPointRenderable=new i({geometry:new u,material:t,mode:i.POINTS}),this._spriteTexture&&t.set("sprite",this._spriteTexture),this._sceneNode.add(this._animatingMarkPointRenderable)},_updateSpriteTexture:function(t,e){this._spriteTexture||(this._spriteTexture=new h({flipY:!1}));var r=this._spriteTexture;r.image=c.makeSpriteFromShape(t,e,r.image),r.dirty()},clear:function(){this._markPointRenderable&&this._markPointRenderable.geometry.clearPoints(),this._animatingMarkPointRenderable&&this._animatingMarkPointRenderable.geometry.clearPoints(),this._elapsedTime=0},setSeries:function(t,e){if(t.markPoint&&t.markPoint.data){this.seriesIndex=e;var r=this.chart,i=r.component,a=i.legend,n=i.dataRange,s=t.markPoint;r.zr;var o=r.query(s,"symbol"),u=r.query(s,"effect.show"),h=r.query(s,"effect.shadowBlur")||0,c=new _({style:{x:0,y:0,width:128,height:128,iconType:o,color:"white",shadowBlur:128*h,shadowColor:"white"}});this._updateSpriteTexture(128,c),u?(this._animatingMarkPointRenderable||this._createAnimatingMarkPointRenderable(),this._animatingMarkPointRenderable.geometry.dirty()):(this._markPointRenderable||this._createMarkPointRenderable(),this._markPointRenderable.geometry.dirty());var f,d=s.data;a&&(f=a.getColor(t.name)),f=r.query(s,"itemStyle.normal.color")||f;for(var m=r.zr.getColor(e),y=r.query(s,"symbolSize")||2,p=0;d.length>p;p++){var v=d[p],g=r.getDataFromOption(v,null),E=null;if(!n||(E=isNaN(g)?b:n.getColor(g),null!=E)){var T=r.query(v,"itemStyle.normal.color"),b=T||E||f||m;"function"==typeof b&&(b=b(v));var x=r.parseColor(b)||new Float32Array(4),R=null==v.symbolSize?y:v.symbolSize;"function"==typeof R&&(R=R(v)),R*=window.devicePixelRatio||1;var A=new l;r.getMarkCoord(e,v,A),u?this._animatingMarkPointRenderable.geometry.addPoint(A,x,R,2*Math.random()):this._markPointRenderable.geometry.addPoint(A,x,R)}}}},getSceneNode:function(){return this._sceneNode},onframe:function(t){if(this._animatingMarkPointRenderable){var e=this._animatingMarkPointRenderable;e.geometry.getVertexNumber()>0&&(this._elapsedTime+=t/1e3,e.material.set("elapsedTime",this._elapsedTime),this.chart.zr.refreshNextFrame())}}},e.inherits(f,r),f}),define("echarts-x/core/Layer3D",["require","qtek/Renderer","qtek/Scene","qtek/camera/Perspective","qtek/camera/Orthographic","qtek/picking/RayPicking","zrender/mixin/Eventful","zrender/tool/util"],function(t){var e=t("qtek/Renderer"),r=t("qtek/Scene"),i=t("qtek/camera/Perspective");t("qtek/camera/Orthographic");var a=t("qtek/picking/RayPicking"),n=t("zrender/mixin/Eventful"),s=t("zrender/tool/util"),o=function(t,a){n.call(this),this.id=t;try{this.renderer=new e,this.renderer.resize(a.getWidth(),a.getHeight())}catch(s){return this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecx-nowebgl",this.dom.innerHTML="Sorry, your browser does support WebGL",void 0}this.dom=this.renderer.canvas;var o=this.dom.style;o.position="absolute",o.left="0",o.top="0",this.camera=new i,this.camera.aspect=a.getWidth()/a.getHeight(),this.scene=new r,this._viewport={x:0,y:0,width:1,height:1},this._initHandlers()};return o.prototype._initHandlers=function(){this.bind("click",this._clickHandler,this),this.bind("mousedown",this._mouseDownHandler,this),this.bind("mouseup",this._mouseUpHandler,this),this.bind("mousemove",this._mouseMoveHandler,this),this._picking=new a({scene:this.scene,camera:this.camera,renderer:this.renderer})},o.prototype.resize=function(t,e){var r=this.renderer;r.resize(t,e);var i=this._viewport;this.setViewport(i.x*t,i.y*e,i.width*t,i.height*e)},o.prototype.setViewport=function(t,e,r,a){var n=this.renderer,s=n.getWidth(),o=n.getHeight(),u=this._viewport;u.x=t/s,u.y=e/o,u.width=r/s,u.height=1-a/o,n.setViewport(t,e,r,a);var h=this.camera;h instanceof i&&(h.aspect=r/a)},o.prototype.refresh=function(){this.renderer.render(this.scene,this.camera)},o.prototype.dispose=function(){this.renderer.disposeScene(this.scene)},o.prototype.onmousedown=function(t){t=t.event;var e=this.pickObject(t.offsetX,t.offsetY);e&&this._dispatchEvent("mousedown",t,e)},o.prototype.onmousemove=function(t){t=t.event;var e=this.pickObject(t.offsetX,t.offsetY);e&&this._dispatchEvent("mousemove",t,e)},o.prototype.onmouseup=function(t){t=t.event;var e=this.pickObject(t.offsetX,t.offsetY);e&&this._dispatchEvent("mouseup",t,e)},o.prototype.onclick=function(t){t=t.event;var e=this.pickObject(t.offsetX,t.offsetY);e&&this._dispatchEvent("click",t,e)},o.prototype.pickObject=function(t,e){return this._picking.pick(t,e)},o.prototype._dispatchEvent=function(t,e,r){var i=r.target;for(r.cancelBubble=!1,r.event=e,r.type=t;i&&(i.trigger(t,r),i=i.getParent(),!r.cancelBubble););},s.inherits(o,n),o}),define("qtek/Renderer",["require","./core/Base","./Texture","./core/glinfo","./core/glenum","./math/BoundingBox","./math/Matrix4","./shader/library","./Material","./math/Vector2","./dep/glmatrix"],function(t){"use strict";var e=t("./core/Base");t("./Texture");var r=t("./core/glinfo"),i=t("./core/glenum"),a=t("./math/BoundingBox"),n=t("./math/Matrix4"),s=t("./shader/library"),o=t("./Material"),u=t("./math/Vector2"),h=t("./dep/glmatrix"),c=h.mat4,l=h.vec3,_=0,f={},d=e.derive(function(){return{canvas:null,width:100,height:100,devicePixelRatio:window.devicePixelRatio||1,color:[0,0,0,0],clear:17664,alhpa:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},_viewportSettings:[],_clearSettings:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height);try{var t={alhpa:this.alhpa,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),!this.gl)throw Error();this.gl.__GLID__=_++,this.width=this.canvas.width,this.height=this.canvas.height,this.resize(this.width,this.height),r.initialize(this.gl)}catch(e){throw"Error creating WebGL Context"}},{resize:function(t,e){var r=this.canvas;t!==void 0?(r.style.width=t+"px",r.style.height=e+"px",r.width=t*this.devicePixelRatio,r.height=e*this.devicePixelRatio,this.width=t,this.height=e):(this.width=r.width/this.devicePixelRatio,this.height=r.height/this.devicePixelRatio),this.setViewport(0,0,t,e)},getWidth:function(){return this.width},getHeight:function(){return this.height},setDevicePixelRatio:function(t){this.devicePixelRatio=t,this.resize(this.width,this.height)},getDevicePixelRatio:function(){return this.devicePixelRatio},setViewport:function(t,e,r,i,a){if("object"==typeof t){var n=t;t=n.x,e=n.y,r=n.width,i=n.height}a=a||this.devicePixelRatio,this.gl.viewport(t*a,e*a,r*a,i*a),this.viewport={x:t,y:e,width:r,height:i}},saveViewport:function(){this._viewportSettings.push(this.viewport)},restoreViewport:function(){this._viewportSettings.length>0&&this.setViewport(this._viewportSettings.pop())},saveClear:function(){this._clearSettings.push(this.clear)},restoreClear:function(){this._clearSettings.length>0&&(this.clear=this._clearSettings.pop())},render:function(t,e,r,i){var a=this.gl;this._sceneRendering=t;var n=this.color;this.clear&&(a.clearColor(n[0],n[1],n[2],n[3]),a.clear(this.clear)),r||t.update(!1),e.getScene()||e.update(!0);var s=t.opaqueQueue,o=t.transparentQueue,u=t.material;if(t.trigger("beforerender",this,t,e),o.length>0)for(var h=c.create(),_=l.create(),f=0;o.length>f;f++){var m=o[f];c.multiply(h,e.viewMatrix._array,m.worldTransform._array),l.transformMat4(_,m.position._array,h),m.__depth=_[2]}s.sort(d.opaqueSortFunc),o.sort(d.transparentSortFunc),t.trigger("beforerender:opaque",this,s),e.sceneBoundingBoxLastFrame.min.set(1/0,1/0,1/0),e.sceneBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0),a.disable(a.BLEND),a.enable(a.DEPTH_TEST);var y=this.renderQueue(s,e,u,i);t.trigger("afterrender:opaque",this,s,y),t.trigger("beforerender:transparent",this,o),a.enable(a.BLEND);var p=this.renderQueue(o,e,u);t.trigger("afterrender:transparent",this,o,p);var v={};for(var g in y)v[g]=y[g]+p[g];return t.trigger("afterrender",this,t,e,v),v},renderQueue:function(t,e,r,i){var a={faceNumber:0,vertexNumber:0,drawCallNumber:0,meshNumber:t.length,renderedMeshNumber:0};c.copy(m.VIEW,e.viewMatrix._array),c.copy(m.PROJECTION,e.projectionMatrix._array),c.multiply(m.VIEWPROJECTION,e.projectionMatrix._array,m.VIEW),c.copy(m.VIEWINVERSE,e.worldTransform._array),c.invert(m.PROJECTIONINVERSE,m.PROJECTION),c.invert(m.VIEWPROJECTIONINVERSE,m.VIEWPROJECTION);var n,u,h,l,_,d,y,p,v=this.gl,g=this._sceneRendering;if(i){var E=new o({shader:s.get("buildin.prez")}),T=E.shader;p=[],T.bind(v),v.colorMask(!1,!1,!1,!1),v.depthMask(!0);for(var b=0;t.length>b;b++){var x=t[b],R=x.worldTransform._array,A=x.geometry;if(c.multiply(m.WORLDVIEW,m.VIEW,R),c.multiply(m.WORLDVIEWPROJECTION,m.VIEWPROJECTION,R),(!A.boundingBox||this._frustumCulling(x,e))&&!x.skeleton){x.cullFace!==d&&(d=x.cullFace,v.cullFace(d)),x.frontFace!==y&&(y=x.frontFace,v.frontFace(y)),x.culling!==_&&(_=x.culling,_?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE));var S=T.matrixSemantics.WORLDVIEWPROJECTION;T.setUniform(v,S.type,S.symbol,m.WORLDVIEWPROJECTION),x.render(v,E),p.push(x)}}v.depthFunc(v.LEQUAL),v.colorMask(!0,!0,!0,!0),v.depthMask(!1)}else p=t;for(var b=0;p.length>b;b++){var x=p[b],N=r||x.material,I=N.shader,A=x.geometry,R=x.worldTransform._array;if(c.copy(m.WORLD,R),c.multiply(m.WORLDVIEW,m.VIEW,R),c.multiply(m.WORLDVIEWPROJECTION,m.VIEWPROJECTION,R),(I.matrixSemantics.WORLDINVERSE||I.matrixSemantics.WORLDINVERSETRANSPOSE)&&c.invert(m.WORLDINVERSE,R),(I.matrixSemantics.WORLDVIEWINVERSE||I.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&c.invert(m.WORLDVIEWINVERSE,m.WORLDVIEW),(I.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||I.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&c.invert(m.WORLDVIEWPROJECTIONINVERSE,m.WORLDVIEWPROJECTION),!A.boundingBox||i||this._frustumCulling(x,e)){if(u!==I){g&&g.isShaderLightNumberChanged(I)&&g.setShaderLightNumber(I);var M=I.bind(v);if(M){if(f[I.__GUID__])continue;if(f[I.__GUID__]=!0,this.throwError)throw Error(M);this.trigger("error",M)}g&&g.setLightUniforms(I,v),u=I}n!==N&&(i||(N.depthTest!==h&&(N.depthTest?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),h=N.depthTest),N.depthMask!==l&&(v.depthMask(N.depthMask),l=N.depthMask)),N.bind(v,n),n=N,N.transparent&&(N.blend?N.blend(v):(v.blendEquationSeparate(v.FUNC_ADD,v.FUNC_ADD),v.blendFuncSeparate(v.SRC_ALPHA,v.ONE_MINUS_SRC_ALPHA,v.ONE,v.ONE_MINUS_SRC_ALPHA))));for(var P=I.matrixSemanticKeys,L=0;P.length>L;L++){var w=P[L],S=I.matrixSemantics[w],O=m[w];if(S.isTranspose){var k=m[S.semanticNoTranspose];c.transpose(O,k)}I.setUniform(v,S.type,S.symbol,O)}x.cullFace!==d&&(d=x.cullFace,v.cullFace(d)),x.frontFace!==y&&(y=x.frontFace,v.frontFace(y)),x.culling!==_&&(_=x.culling,_?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE));var C=x.render(v,r);C&&(a.faceNumber+=C.faceNumber,a.vertexNumber+=C.vertexNumber,a.drawCallNumber+=C.drawCallNumber,a.renderedMeshNumber++)}}return a},_frustumCulling:function(){var t=new a,e=new n;return function(r,i){var a=r.geometry.boundingBox;if(e._array=m.WORLDVIEW,t.copy(a),t.applyTransform(e),r.castShadow&&i.sceneBoundingBoxLastFrame.union(t),r.frustumCulling){if(!t.intersectBoundingBox(i.frustum.boundingBox))return!1;e._array=m.PROJECTION,t.max._array[2]>0&&0>t.min._array[2]&&(t.max._array[2]=-1e-20),t.applyProjection(e);var n=t.min._array,s=t.max._array;if(-1>s[0]||n[0]>1||-1>s[1]||n[1]>1||-1>s[2]||n[2]>1)return!1}return!0}}(),disposeScene:function(t){this.disposeNode(t,!0,!0),t.dispose()},disposeNode:function(t,e,r){var i={},a=this.gl;t.getParent()&&t.getParent().remove(t),t.traverse(function(t){t.geometry&&e&&t.geometry.dispose(a),t.material&&(i[t.material.__GUID__]=t.material),t.dispose&&t.dispose(a)});for(var n in i){var s=i[n];s.dispose(a,r)}},disposeShader:function(t){t.dispose(this.gl)},disposeGeometry:function(t){t.dispose(this.gl)},disposeTexture:function(t){t.dispose(this.gl)},disposeFrameBuffer:function(t){t.dispose(this.gl)},dispose:function(){r.dispose(this.gl)},screenToNdc:function(t,e,r){r||(r=new u),e=this.height-e;var i=this.viewport;this.devicePixelRatio;var a=r._array;return a[0]=(t-i.x)/i.width,a[0]=2*a[0]-1,a[1]=(e-i.y)/i.height,a[1]=2*a[1]-1,r}});d.opaqueSortFunc=function(t,e){return t.material.shader===e.material.shader?t.material===e.material?t.geometry.__GUID__-e.geometry.__GUID__:t.material.__GUID__-e.material.__GUID__:t.material.shader.__GUID__-e.material.shader.__GUID__},d.transparentSortFunc=function(t,e){return t.__depth===e.__depth?t.material.shader===e.material.shader?t.material===e.material?t.geometry.__GUID__-e.geometry.__GUID__:t.material.__GUID__-e.material.__GUID__:t.material.shader.__GUID__-e.material.shader.__GUID__:t.__depth-e.__depth};var m={WORLD:c.create(),VIEW:c.create(),PROJECTION:c.create(),WORLDVIEW:c.create(),VIEWPROJECTION:c.create(),WORLDVIEWPROJECTION:c.create(),WORLDINVERSE:c.create(),VIEWINVERSE:c.create(),PROJECTIONINVERSE:c.create(),WORLDVIEWINVERSE:c.create(),VIEWPROJECTIONINVERSE:c.create(),WORLDVIEWPROJECTIONINVERSE:c.create(),WORLDTRANSPOSE:c.create(),VIEWTRANSPOSE:c.create(),PROJECTIONTRANSPOSE:c.create(),WORLDVIEWTRANSPOSE:c.create(),VIEWPROJECTIONTRANSPOSE:c.create(),WORLDVIEWPROJECTIONTRANSPOSE:c.create(),WORLDINVERSETRANSPOSE:c.create(),VIEWINVERSETRANSPOSE:c.create(),PROJECTIONINVERSETRANSPOSE:c.create(),WORLDVIEWINVERSETRANSPOSE:c.create(),VIEWPROJECTIONINVERSETRANSPOSE:c.create(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:c.create()};return d.COLOR_BUFFER_BIT=i.COLOR_BUFFER_BIT,d.DEPTH_BUFFER_BIT=i.DEPTH_BUFFER_BIT,d.STENCIL_BUFFER_BIT=i.STENCIL_BUFFER_BIT,d}),define("qtek/Scene",["require","./Node","./Light"],function(t){"use strict";function e(t,e){return e.castShadow&&!t.castShadow?!0:void 0}var r=t("./Node"),i=t("./Light"),a=r.derive(function(){return{material:null,autoUpdate:!0,opaqueQueue:[],transparentQueue:[],lights:[],_lightUniforms:{},_lightNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0,AMBIENT_LIGHT:0},_opaqueObjectCount:0,_transparentObjectCount:0,_nodeRepository:{}}},function(){this._scene=this},{addToScene:function(t){t.name&&(this._nodeRepository[t.name]=t)},removeFromScene:function(t){t.name&&delete this._nodeRepository[t.name]},getNode:function(t){return this._nodeRepository[t]},cloneNode:function(t){var e=t.clone(),r={},i=function(a,n){a.skeleton&&(n.skeleton=a.skeleton.clone(t,e),n.joints=a.joints.slice()),a.material&&(r[a.material.__GUID__]={oldMat:a.material});for(var s=0;a._children.length>s;s++)i(a._children[s],n._children[s])};i(t,e);for(var a in r)r[a].newMat=r[a].oldMat.clone();return e.traverse(function(t){t.material&&(t.material=r[t.material.__GUID__].newMat)}),e},update:function(t){if(this.autoUpdate||t){r.prototype.update.call(this,t);var e=this.lights,i=this.material&&this.material.transparent;this._opaqueObjectCount=0,this._transparentObjectCount=0,e.length=0,this._updateRenderQueue(this,i),this.opaqueQueue.length=this._opaqueObjectCount,this.transparentQueue.length=this._transparentObjectCount;for(var a in this._lightNumber)this._lightNumber[a]=0;for(var n=0;e.length>n;n++){var s=e[n];this._lightNumber[s.type]++}this._updateLightUniforms()}},_updateRenderQueue:function(t,e){if(t.visible)for(var r=0;t._children.length>r;r++){var a=t._children[r];a instanceof i&&this.lights.push(a),a.isRenderable()&&(a.material.transparent||e?this.transparentQueue[this._transparentObjectCount++]=a:this.opaqueQueue[this._opaqueObjectCount++]=a),a._children.length>0&&this._updateRenderQueue(a)}},_updateLightUniforms:function(){var t=this.lights;t.sort(e);var r=this._lightUniforms;for(var i in r)r[i].value.length=0;for(var a=0;t.length>a;a++){var n=t[a];for(i in n.uniformTemplates){var s=n.uniformTemplates[i];r[i]||(r[i]={type:"",value:[]});var o=s.value(n),u=r[i];switch(u.type=s.type+"v",s.type){case"1i":case"1f":u.value.push(o);break;case"2f":case"3f":case"4f":for(var h=0;o.length>h;h++)u.value.push(o[h]);break;default:console.error("Unkown light uniform type "+s.type)}}}},isShaderLightNumberChanged:function(t){return t.lightNumber.POINT_LIGHT!==this._lightNumber.POINT_LIGHT||t.lightNumber.DIRECTIONAL_LIGHT!==this._lightNumber.DIRECTIONAL_LIGHT||t.lightNumber.SPOT_LIGHT!==this._lightNumber.SPOT_LIGHT||t.lightNumber.AMBIENT_LIGHT!==this._lightNumber.AMBIENT_LIGHT},setShaderLightNumber:function(t){for(var e in this._lightNumber)t.lightNumber[e]=this._lightNumber[e];t.dirty()},setLightUniforms:function(t,e){for(var r in this._lightUniforms){var i=this._lightUniforms[r];t.setUniform(e,i.type,r,i.value)}},dispose:function(){this.material=null,this.opaqueQueue=[],this.transparentQueue=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});return a}),define("qtek/camera/Perspective",["require","../Camera"],function(t){"use strict";var e=t("../Camera"),r=e.derive({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var t=this.fov/180*Math.PI;this.projectionMatrix.perspective(t,this.aspect,this.near,this.far)},clone:function(){var t=e.prototype.clone.call(this);return t.fov=this.fov,t.aspect=this.aspect,t.near=this.near,t.far=this.far,t}});return r}),define("qtek/camera/Orthographic",["require","../Camera"],function(t){"use strict";var e=t("../Camera"),r=e.derive({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},clone:function(){var t=e.prototype.clone.call(this);return t.left=this.left,t.right=this.right,t.near=this.near,t.far=this.far,t.top=this.top,t.bottom=this.bottom,t}});return r}),define("qtek/picking/RayPicking",["require","../core/Base","../math/Ray","../math/Vector2","../math/Vector3","../math/Matrix4","../Renderable","../StaticGeometry","../core/glenum"],function(t){var e=t("../core/Base"),r=t("../math/Ray"),i=t("../math/Vector2"),a=t("../math/Vector3"),n=t("../math/Matrix4"),s=t("../Renderable"),o=t("../StaticGeometry"),u=t("../core/glenum"),h=e.derive({scene:null,camera:null,renderer:null},function(){this._ray=new r,this._ndc=new i},{pick:function(t,e){var r=this.pickAll(t,e);return r[0]||null},pickAll:function(t,e){this.renderer.screenToNdc(t,e,this._ndc),this.camera.castRay(this._ndc,this._ray);var r=[];return this._intersectNode(this.scene,r),r.sort(this._intersectionCompareFunc),r},_intersectNode:function(t,e){t instanceof s&&t.isRenderable()&&!t.ignorePicking&&t.geometry.isUseFace()&&this._intersectRenderable(t,e);for(var r=0;t._children.length>r;r++)this._intersectNode(t._children[r],e)},_intersectRenderable:function(){var t=new a,e=new a,i=new a,s=new r,c=new n;return function(r,l){s.copy(this._ray),n.invert(c,r.worldTransform),s.applyTransform(c);var _=r.geometry;if(_.boundingBox&&!s.intersectBoundingBox(_.boundingBox))return!1;var f,d=_ instanceof o,m=r.cullFace===u.BACK&&r.frontFace===u.CCW||r.cullFace===u.FRONT&&r.frontFace===u.CW;if(d)for(var y=_.faces,p=_.attributes.position.value,v=0;y.length>v;){var g=3*y[v++],E=3*y[v++],T=3*y[v++];if(t._array[0]=p[g],t._array[1]=p[g+1],t._array[2]=p[g+2],e._array[0]=p[E],e._array[1]=p[E+1],e._array[2]=p[E+2],i._array[0]=p[T],i._array[1]=p[T+1],i._array[2]=p[T+2],f=m?s.intersectTriangle(t,e,i,r.culling):s.intersectTriangle(t,i,e,r.culling)){var b=new a;a.transformMat4(b,f,r.worldTransform),l.push(new h.Intersection(f,b,r,[g,E,T],a.dist(b,this._ray.origin)))}}else for(var y=_.faces,p=_.attributes.position.value,v=0;y.length>v;v++){var x=y[v],g=x[0],E=x[1],T=x[2];if(t.setArray(p[g]),e.setArray(p[E]),i.setArray(p[T]),f=m?s.intersectTriangle(t,e,i,r.culling):s.intersectTriangle(t,i,e,r.culling)){var b=new a;a.transformMat4(b,f,r.worldTransform),l.push(new h.Intersection(f,b,r,[g,E,T],a.dist(b,this._ray.origin)))}}}}(),_intersectionCompareFunc:function(t,e){return t.distance-e.distance}});return h.Intersection=function(t,e,r,i,a){this.point=t,this.pointWorld=e,this.target=r,this.face=i,this.distance=a},h}),define("qtek/shader/library",["require","../Shader","../core/util"],function(t){function e(){this._pool={}}function r(t,e,r){a[t]={vertex:e,fragment:r}}var i=t("../Shader");t("../core/util");var a={};e.prototype.get=function(t,e){var r=[],n={},s={};"string"==typeof e?r=Array.prototype.slice.call(arguments,1):"[object Object]"==Object.prototype.toString.call(e)?(r=e.textures||[],n=e.vertexDefines||{},s=e.fragmentDefines||{}):e instanceof Array&&(r=e);var o=Object.keys(n),u=Object.keys(s);r.sort(),o.sort(),u.sort();var h=[t];h=h.concat(r);for(var c=0;o.length>c;c++)h.push(n[o[c]]);for(var c=0;u.length>c;c++)h.push(s[u[c]]);var l=h.join("_");if(this._pool[l])return this._pool[l];var _=a[t];if(!_)return console.error('Shader "'+t+'"'+" is not in the library"),void 0;for(var f=new i({vertex:_.vertex,fragment:_.fragment}),c=0;r.length>c;c++)f.enableTexture(r[c]);for(var t in n)f.define("vertex",t,n[t]);for(var t in s)f.define("fragment",t,s[t]);return this._pool[l]=f,f},e.prototype.clear=function(){this._pool={}};var n=new e;return{createLibrary:function(){return new e},get:function(){return n.get.apply(n,arguments)},template:r,clear:function(){return n.clear()}}}),define("qtek/math/Vector2",["require","../dep/glmatrix"],function(t){"use strict";var e=t("../dep/glmatrix"),r=e.vec2,i=function(t,e){t=t||0,e=e||0,this._array=r.fromValues(t,e),this._dirty=!0};if(i.prototype={constructor:i,add:function(t){return r.add(this._array,this._array,t._array),this._dirty=!0,this},set:function(t,e){return this._array[0]=t,this._array[1]=e,this._dirty=!0,this},setArray:function(t){return this._array[0]=t[0],this._array[1]=t[1],this._dirty=!0,this},clone:function(){return new i(this.x,this.y)},copy:function(t){return r.copy(this._array,t._array),this._dirty=!0,this},cross:function(t,e){return r.cross(t._array,this._array,e._array),t._dirty=!0,this},dist:function(t){return r.dist(this._array,t._array)},distance:function(t){return r.distance(this._array,t._array)},div:function(t){return r.div(this._array,this._array,t._array),this._dirty=!0,this},divide:function(t){return r.divide(this._array,this._array,t._array),this._dirty=!0,this},dot:function(t){return r.dot(this._array,t._array)},len:function(){return r.len(this._array)},length:function(){return r.length(this._array)},lerp:function(t,e,i){return r.lerp(this._array,t._array,e._array,i),this._dirty=!0,this},min:function(t){return r.min(this._array,this._array,t._array),this._dirty=!0,this},max:function(t){return r.max(this._array,this._array,t._array),this._dirty=!0,this},mul:function(t){return r.mul(this._array,this._array,t._array),this._dirty=!0,this},multiply:function(t){return r.multiply(this._array,this._array,t._array),this._dirty=!0,this},negate:function(){return r.negate(this._array,this._array),this._dirty=!0,this},normalize:function(){return r.normalize(this._array,this._array),this._dirty=!0,this},random:function(t){return r.random(this._array,t),this._dirty=!0,this},scale:function(t){return r.scale(this._array,this._array,t),this._dirty=!0,this},scaleAndAdd:function(t,e){return r.scaleAndAdd(this._array,this._array,t._array,e),this._dirty=!0,this},sqrDist:function(t){return r.sqrDist(this._array,t._array)},squaredDistance:function(t){return r.squaredDistance(this._array,t._array)},sqrLen:function(){return r.sqrLen(this._array)},squaredLength:function(){return r.squaredLength(this._array)},sub:function(t){return r.sub(this._array,this._array,t._array),this._dirty=!0,this},subtract:function(t){return r.subtract(this._array,this._array,t._array),this._dirty=!0,this},transformMat2:function(t){return r.transformMat2(this._array,this._array,t._array),this._dirty=!0,this},transformMat2d:function(t){return r.transformMat2d(this._array,this._array,t._array),this._dirty=!0,this},transformMat3:function(t){return r.transformMat3(this._array,this._array,t._array),this._dirty=!0,this},transformMat4:function(t){return r.transformMat4(this._array,this._array,t._array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}},Object.defineProperty){var a=i.prototype;Object.defineProperty(a,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]=t,this._dirty=!0}}),Object.defineProperty(a,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]=t,this._dirty=!0}})}return i.add=function(t,e,i){return r.add(t._array,e._array,i._array),t._dirty=!0,t},i.set=function(t,e,i){return r.set(t._array,e,i),t._dirty=!0,t},i.copy=function(t,e){return r.copy(t._array,e._array),t._dirty=!0,t},i.cross=function(t,e,i){return r.cross(t._array,e._array,i._array),t._dirty=!0,t},i.dist=function(t,e){return r.distance(t._array,e._array)},i.distance=i.dist,i.div=function(t,e,i){return r.divide(t._array,e._array,i._array),t._dirty=!0,t},i.divide=i.div,i.dot=function(t,e){return r.dot(t._array,e._array)},i.len=function(t){return r.length(t._array)},i.lerp=function(t,e,i,a){return r.lerp(t._array,e._array,i._array,a),t._dirty=!0,t},i.min=function(t,e,i){return r.min(t._array,e._array,i._array),t._dirty=!0,t},i.max=function(t,e,i){return r.max(t._array,e._array,i._array),t._dirty=!0,t},i.mul=function(t,e,i){return r.multiply(t._array,e._array,i._array),t._dirty=!0,t},i.multiply=i.mul,i.negate=function(t,e){return r.negate(t._array,e._array),t._dirty=!0,t},i.normalize=function(t,e){return r.normalize(t._array,e._array),t._dirty=!0,t},i.random=function(t,e){return r.random(t._array,e),t._dirty=!0,t},i.scale=function(t,e,i){return r.scale(t._array,e._array,i),t._dirty=!0,t},i.scaleAndAdd=function(t,e,i,a){return r.scaleAndAdd(t._array,e._array,i._array,a),t._dirty=!0,t},i.sqrDist=function(t,e){return r.sqrDist(t._array,e._array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(t){return r.sqrLen(t._array)},i.squaredLength=i.sqrLen,i.sub=function(t,e,i){return r.subtract(t._array,e._array,i._array),t._dirty=!0,t},i.subtract=i.sub,i.transformMat2=function(t,e,i){return r.transformMat2(t._array,e._array,i._array),t._dirty=!0,t},i.transformMat2d=function(t,e,i){return r.transformMat2d(t._array,e._array,i._array),t._dirty=!0,t},i.transformMat3=function(t,e,i){return r.transformMat3(t._array,e._array,i._array),t._dirty=!0,t},i.transformMat4=function(t,e,i){return r.transformMat4(t._array,e._array,i._array),t._dirty=!0,t},i}),define("qtek/Light",["require","./Node","./Shader","./light/light.essl"],function(t){"use strict";var e=t("./Node"),r=t("./Shader"),i=e.derive(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512}},{type:"",clone:function(){var t=e.prototype.clone.call(this);return t.color=Array.prototype.slice.call(this.color),t.intensity=this.intensity,t.castShadow=this.castShadow,t.shadowResolution=this.shadowResolution,t}});return r["import"](t("./light/light.essl")),i}),define("qtek/light/light.essl",function(){return"@export buildin.header.directional_light\nuniform vec3 directionalLightDirection[ DIRECTIONAL_LIGHT_NUMBER ] : unconfigurable;\nuniform vec3 directionalLightColor[ DIRECTIONAL_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.ambient_light\nuniform vec3 ambientLightColor[ AMBIENT_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.point_light\nuniform vec3 pointLightPosition[ POINT_LIGHT_NUMBER ] : unconfigurable;\nuniform float pointLightRange[ POINT_LIGHT_NUMBER ] : unconfigurable;\nuniform vec3 pointLightColor[ POINT_LIGHT_NUMBER ] : unconfigurable;\n@end\n\n@export buildin.header.spot_light\nuniform vec3 spotLightPosition[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform vec3 spotLightDirection[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightRange[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightUmbraAngleCosine[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightPenumbraAngleCosine[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform float spotLightFalloffFactor[SPOT_LIGHT_NUMBER] : unconfigurable;\nuniform vec3 spotLightColor[SPOT_LIGHT_NUMBER] : unconfigurable;\n@end"}),define("qtek/Camera",["require","./Node","./math/Matrix4","./math/Frustum","./math/BoundingBox","./math/Ray","./dep/glmatrix"],function(t){"use strict";var e=t("./Node"),r=t("./math/Matrix4"),i=t("./math/Frustum"),a=t("./math/BoundingBox"),n=t("./math/Ray"),s=t("./dep/glmatrix"),o=s.mat4,u=s.vec3,h=s.vec4,c=e.derive(function(){return{projectionMatrix:new r,invProjectionMatrix:new r,viewMatrix:new r,frustum:new i,sceneBoundingBoxLastFrame:new a}
},function(){this.update(!0)},{update:function(t){e.prototype.update.call(this,t),o.invert(this.viewMatrix._array,this.worldTransform._array),this.updateProjectionMatrix(),o.invert(this.invProjectionMatrix._array,this.projectionMatrix._array),this.frustum.setFromProjection(this.projectionMatrix)},updateProjectionMatrix:function(){},castRay:function(){var t=h.create();return function(e,r){var i=void 0!==r?r:new n,a=e._array[0],s=e._array[1];return h.set(t,a,s,-1,1),h.transformMat4(t,t,this.invProjectionMatrix._array),h.transformMat4(t,t,this.worldTransform._array),u.scale(i.origin._array,t,1/t[3]),h.set(t,a,s,1,1),h.transformMat4(t,t,this.invProjectionMatrix._array),h.transformMat4(t,t,this.worldTransform._array),u.scale(t,t,1/t[3]),u.sub(i.direction._array,t,i.origin._array),u.normalize(i.direction._array,i.direction._array),i.direction._dirty=!0,i.origin._dirty=!0,i}}()});return c}),define("qtek/math/Frustum",["require","./Vector3","./BoundingBox","./Plane","../dep/glmatrix"],function(t){"use strict";t("./Vector3");var e=t("./BoundingBox"),r=t("./Plane"),i=t("../dep/glmatrix"),a=i.vec3,n=function(){this.planes=[];for(var t=0;6>t;t++)this.planes.push(new r);this.boundingBox=new e,this.vertices=[];for(var t=0;8>t;t++)this.vertices[t]=a.fromValues(0,0,0)};return n.prototype={setFromProjection:function(t){var e=this.planes,r=t._array,i=r[0],n=r[1],s=r[2],o=r[3],u=r[4],h=r[5],c=r[6],l=r[7],_=r[8],f=r[9],d=r[10],m=r[11],y=r[12],p=r[13],v=r[14],g=r[15];if(a.set(e[0].normal._array,o-i,l-u,m-_),e[0].distance=-(g-y),e[0].normalize(),a.set(e[1].normal._array,o+i,l+u,m+_),e[1].distance=-(g+y),e[1].normalize(),a.set(e[2].normal._array,o+n,l+h,m+f),e[2].distance=-(g+p),e[2].normalize(),a.set(e[3].normal._array,o-n,l-h,m-f),e[3].distance=-(g-p),e[3].normalize(),a.set(e[4].normal._array,o-s,l-c,m-d),e[4].distance=-(g-v),e[4].normalize(),a.set(e[5].normal._array,o+s,l+c,m+d),e[5].distance=-(g+v),e[5].normalize(),0===g){var E=h/i,T=-v/(d-1),b=-v/(d+1),x=-b/h,R=-T/h;this.boundingBox.min.set(-x*E,-x,b),this.boundingBox.max.set(x*E,x,T);var A=this.vertices;a.set(A[0],-x*E,-x,b),a.set(A[1],-x*E,x,b),a.set(A[2],x*E,-x,b),a.set(A[3],x*E,x,b),a.set(A[4],-R*E,-R,T),a.set(A[5],-R*E,R,T),a.set(A[6],R*E,-R,T),a.set(A[7],R*E,R,T)}else{var S=(-1-y)/i,N=(1-y)/i,I=(1-p)/h,M=(-1-p)/h,P=(-1-v)/d,L=(1-v)/d;this.boundingBox.min.set(S,M,L),this.boundingBox.max.set(N,I,P);for(var w=0;8>w;w++)a.copy(this.vertices[w],this.boundingBox.vertices[w])}},getTransformedBoundingBox:function(){var t=a.create();return function(e,r){var i=this.vertices,n=r._array,s=e.min._array,o=e.max._array,u=i[0];a.transformMat4(t,u,n),a.copy(s,t),a.copy(o,t);for(var h=1;8>h;h++)u=i[h],a.transformMat4(t,u,n),s[0]=Math.min(t[0],s[0]),s[1]=Math.min(t[1],s[1]),s[2]=Math.min(t[2],s[2]),o[0]=Math.max(t[0],o[0]),o[1]=Math.max(t[1],o[1]),o[2]=Math.max(t[2],o[2]);return e.min._dirty=!0,e.max._dirty=!0,e}}()},n}),define("qtek/math/Ray",["require","./Vector3","../dep/glmatrix"],function(t){"use strict";var e=t("./Vector3"),r=t("../dep/glmatrix"),i=r.vec3,a=1e-5,n=function(t,r){this.origin=t||new e,this.direction=r||new e};return n.prototype={constructor:n,intersectPlane:function(t,r){var a=t.normal._array,n=t.distance,s=this.origin._array,o=this.direction._array,u=i.dot(a,o);if(0===u)return null;r||(r=new e);var h=(i.dot(a,s)-n)/u;return i.scaleAndAdd(r._array,s,o,-h),r._dirty=!0,r},mirrorAgainstPlane:function(t){var e=i.dot(t.normal._array,this.direction._array);i.scaleAndAdd(this.direction._array,this.direction._array,t.normal._array,2*-e),this.direction._dirty=!0},distanceToPoint:function(){var t=i.create();return function(e){i.sub(t,e,this.origin._array);var r=i.dot(t,this.direction._array);if(0>r)return i.distance(this.origin._array,e);var a=i.lenSquared(t);return Math.sqrt(a-r*r)}}(),intersectSphere:function(){var t=i.create();return function(r,a,n){var s=this.origin._array,o=this.direction._array;i.sub(t,r,s);var u=i.dot(t,o),h=i.lenSquared(t),c=h-u*u,l=a*a;if(!(c>l)){var _=Math.sqrt(l-c),f=u-_,d=u+_;return n||(n=new e),0>f?0>d?null:(i.scaleAndAdd(n._array,s,o,d),n):(i.scaleAndAdd(n._array,s,o,f),n)}}}(),intersectBoundingBox:function(t,r){var a,n,s,o,u,h,c=this.direction._array,l=this.origin._array,_=t.min._array,f=t.max._array,d=1/c[0],m=1/c[1],y=1/c[2];if(d>=0?(a=(_[0]-l[0])*d,n=(f[0]-l[0])*d):(n=(_[0]-l[0])*d,a=(f[0]-l[0])*d),m>=0?(s=(_[1]-l[1])*m,o=(f[1]-l[1])*m):(o=(_[1]-l[1])*m,s=(f[1]-l[1])*m),a>o||s>n)return null;if((s>a||a!==a)&&(a=s),(n>o||n!==n)&&(n=o),y>=0?(u=(_[2]-l[2])*y,h=(f[2]-l[2])*y):(h=(_[2]-l[2])*y,u=(f[2]-l[2])*y),a>h||u>n)return null;if((u>a||a!==a)&&(a=u),(n>h||n!==n)&&(n=h),0>n)return null;var p=a>=0?a:n;return r||(r=new e),i.scaleAndAdd(r._array,l,c,p),r},intersectTriangle:function(){var t=i.create(),r=i.create(),n=i.create(),s=i.create();return function(o,u,h,c,l,_){var f=this.direction._array,d=this.origin._array;o=o._array,u=u._array,h=h._array,i.sub(t,u,o),i.sub(r,h,o),i.cross(s,r,f);var m=i.dot(t,s);if(c){if(m>-a)return null}else if(m>-a&&a>m)return null;i.sub(n,d,o);var y=i.dot(s,n)/m;if(0>y||y>1)return null;i.cross(s,t,n);var p=i.dot(f,s)/m;if(0>p||p>1||y+p>1)return null;i.cross(s,t,r);var v=-i.dot(n,s)/m;return 0>v?null:(l||(l=new e),_&&e.set(_,1-y-p,y,p),i.scaleAndAdd(l._array,d,f,v),l)}}(),applyTransform:function(t){e.add(this.direction,this.direction,this.origin),e.transformMat4(this.origin,this.origin,t),e.transformMat4(this.direction,this.direction,t),e.sub(this.direction,this.direction,this.origin),e.normalize(this.direction,this.direction)},copy:function(t){e.copy(this.origin,t.origin),e.copy(this.direction,t.direction)},clone:function(){var t=new n;return t.copy(this),t}},n}),define("qtek/math/Plane",["require","./Vector3","../dep/glmatrix"],function(t){"use strict";var e=t("./Vector3"),r=t("../dep/glmatrix"),i=r.vec3,a=r.mat4,n=r.vec4,s=function(t,r){this.normal=t||new e(0,1,0),this.distance=r||0};return s.prototype={constructor:s,distanceToPoint:function(t){return i.dot(t._array,this.normal._array)-this.distance},projectPoint:function(t,r){r||(r=new e);var a=this.distanceToPoint(t);return i.scaleAndAdd(r._array,t._array,this.normal._array,-a),r._dirty=!0,r},normalize:function(){var t=1/i.len(this.normal._array);i.scale(this.normal._array,t),this.distance*=t},intersectFrustum:function(t){for(var e=t.vertices,r=this.normal._array,a=i.dot(e[0]._array,r)>this.distance,n=1;8>n;n++)if(i.dot(e[n]._array,r)>this.distance!=a)return!0},intersectLine:function(){var t=i.create();return function(r,a,n){var s=this.distanceToPoint(r),o=this.distanceToPoint(a);if(s>0&&o>0||0>s&&0>o)return null;var u=this.normal._array,h=this.distance,c=r._array;i.sub(t,a._array,r._array),i.normalize(t,t);var l=i.dot(u,t);if(0===l)return null;n||(n=new e);var _=(i.dot(u,c)-h)/l;return i.scaleAndAdd(n._array,c,t,-_),n._dirty=!0,n}}(),applyTransform:function(){var t=a.create(),e=n.create(),r=n.create();return r[3]=1,function(s){s=s._array,i.scale(r,this.normal._array,this.distance),n.transformMat4(r,r,s),this.distance=i.dot(r,this.normal._array),a.invert(t,s),a.transpose(t,t),e[3]=0,i.copy(e,this.normal._array),n.transformMat4(e,e,t),i.copy(this.normal._array,e)}}(),copy:function(t){i.copy(this.normal._array,t.normal._array),this.normal._dirty=!0,this.distance=t.distance},clone:function(){var t=new s;return t.copy(this),t}},s}),define("qtek/StaticGeometry",["require","./Geometry","./math/BoundingBox","./dep/glmatrix","./core/glenum"],function(t){"use strict";var e=t("./Geometry"),r=t("./math/BoundingBox"),i=t("./dep/glmatrix"),a=t("./core/glenum"),n=i.mat4,s=i.vec3,o=e.derive(function(){return{attributes:{position:new e.Attribute("position","float",3,"POSITION",!1),texcoord0:new e.Attribute("texcoord0","float",2,"TEXCOORD_0",!1),texcoord1:new e.Attribute("texcoord1","float",2,"TEXCOORD_1",!1),normal:new e.Attribute("normal","float",3,"NORMAL",!1),tangent:new e.Attribute("tangent","float",4,"TANGENT",!1),color:new e.Attribute("color","float",4,"COLOR",!1),weight:new e.Attribute("weight","float",3,"WEIGHT",!1),joint:new e.Attribute("joint","float",4,"JOINT",!1),barycentric:new e.Attribute("barycentric","float",3,null,!1)},hint:a.STATIC_DRAW,faces:null,_normalType:"vertex",_enabledAttributes:null}},{dirty:function(){this._cache.dirtyAll(),this._enabledAttributes=null},getVertexNumber:function(){var t=this.attributes[this.mainAttribute];return t&&t.value?t.value.length/t.size:0},getFaceNumber:function(){return this.faces?this.faces.length/3:0},getFace:function(t,e){return this.getFaceNumber()>t&&t>=0?(e||(e=s.create()),e[0]=this.faces[3*t],e[1]=this.faces[3*t+1],e[2]=this.faces[3*t+2],e):void 0},isUseFace:function(){return this.useFace&&null!=this.faces},createAttribute:function(t,r,i,a){var n=new e.Attribute(t,r,i,a,!1);return this.attributes[t]=n,this._attributeList.push(t),n},removeAttribute:function(t){var e=this._attributeList.indexOf(t);return e>=0?(this._attributeList.splice(e,1),delete this.attributes[t],!0):!1},getEnabledAttributes:function(){if(this._enabledAttributes)return this._enabledAttributes;for(var t=[],e=this.getVertexNumber(),r=0;this._attributeList.length>r;r++){var i=this._attributeList[r],a=this.attributes[i];a.value&&a.value.length===e*a.size&&t.push(i)}return this._enabledAttributes=t,t},getBufferChunks:function(t){return this._cache.use(t.__GLID__),this._cache.isDirty()&&(this._updateBuffer(t),this._cache.fresh()),this._cache.get("chunks")},_updateBuffer:function(t){var r=this._cache.get("chunks"),i=!1;r||(r=[],r[0]={attributeBuffers:[],indicesBuffer:null},this._cache.put("chunks",r),i=!0);for(var a=r[0],n=a.attributeBuffers,s=a.indicesBuffer,o=this.getEnabledAttributes(),u=0,h=0,c=0;o.length>c;c++){var l,_=o[c],f=this.attributes[_];if(!i){for(var d=u;n.length>d;d++)if(n[d].name===_){l=n[d],u=d+1;break}if(!l)for(var d=u-1;d>=0;d--)if(n[d].name===_){l=n[d],u=d;break}}var m;m=l?l.buffer:t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,f.value,this.hint),n[h++]=new e.AttributeBuffer(_,f.type,m,f.size,f.semantic)}n.length=h,this.isUseFace()&&(s||(s=new e.IndicesBuffer(t.createBuffer()),a.indicesBuffer=s),s.count=this.faces.length,t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,s.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.faces,this.hint))},generateVertexNormals:function(){var t=this.faces,e=this.attributes.position.value,r=this.attributes.normal.value;if(r&&r.length===e.length)for(var i=0;r.length>i;i++)r[i]=0;else r=this.attributes.normal.value=new Float32Array(e.length);for(var a=s.create(),n=s.create(),o=s.create(),u=s.create(),h=s.create(),c=s.create(),l=0;t.length>l;){var _=t[l++],f=t[l++],d=t[l++];s.set(a,e[3*_],e[3*_+1],e[3*_+2]),s.set(n,e[3*f],e[3*f+1],e[3*f+2]),s.set(o,e[3*d],e[3*d+1],e[3*d+2]),s.sub(u,a,n),s.sub(h,n,o),s.cross(c,u,h);for(var i=0;3>i;i++)r[3*_+i]=r[3*_+i]+c[i],r[3*f+i]=r[3*f+i]+c[i],r[3*d+i]=r[3*d+i]+c[i]}for(var i=0;r.length>i;)s.set(c,r[i],r[i+1],r[i+2]),s.normalize(c,c),r[i++]=c[0],r[i++]=c[1],r[i++]=c[2]},generateFaceNormals:function(){this.isUniqueVertex()||this.generateUniqueVertex();var t=this.faces,e=this.attributes.position.value,r=this.attributes.normal.value,i=s.create(),a=s.create(),n=s.create(),o=s.create(),u=s.create(),h=s.create();r||(r=this.attributes.position.value=new Float32Array(e.length));for(var c=0;t.length>c;){var l=t[c++],_=t[c++],f=t[c++];s.set(i,e[3*l],e[3*l+1],e[3*l+2]),s.set(a,e[3*_],e[3*_+1],e[3*_+2]),s.set(n,e[3*f],e[3*f+1],e[3*f+2]),s.sub(o,i,a),s.sub(u,a,n),s.cross(h,o,u),s.normalize(h,h);for(var d=0;3>d;d++)r[3*l+d]=h[d],r[3*_+d]=h[d],r[3*f+d]=h[d]}},generateTangents:function(){var t=this.getVertexNumber();this.attributes.tangent.value||(this.attributes.tangent.value=new Float32Array(4*t));for(var e=this.attributes.texcoord0.value,r=this.attributes.position.value,i=this.attributes.tangent.value,a=this.attributes.normal.value,n=[],o=[],u=0;t>u;u++)n[u]=[0,0,0],o[u]=[0,0,0];for(var h=[0,0,0],c=[0,0,0],u=0;this.faces.length>u;){var l=this.faces[u++],_=this.faces[u++],f=this.faces[u++],d=e[2*l],m=e[2*_],y=e[2*f],p=e[2*l+1],v=e[2*_+1],g=e[2*f+1],E=r[3*l],T=r[3*_],b=r[3*f],x=r[3*l+1],R=r[3*_+1],A=r[3*f+1],S=r[3*l+2],N=r[3*_+2],I=r[3*f+2],M=T-E,P=b-E,L=R-x,w=A-x,O=N-S,k=I-S,C=m-d,D=y-d,B=v-p,U=g-p,F=1/(C*U-B*D);h[0]=(U*M-B*P)*F,h[1]=(U*L-B*w)*F,h[2]=(U*O-B*k)*F,c[0]=(C*P-D*M)*F,c[1]=(C*w-D*L)*F,c[2]=(C*k-D*O)*F,s.add(n[l],n[l],h),s.add(n[_],n[_],h),s.add(n[f],n[f],h),s.add(o[l],o[l],c),s.add(o[_],o[_],c),s.add(o[f],o[f],c)}for(var q=s.create(),V=s.create(),G=s.create(),u=0;t>u;u++){G[0]=a[3*u],G[1]=a[3*u+1],G[2]=a[3*u+2];var z=n[u];s.scale(q,G,s.dot(G,z)),s.sub(q,z,q),s.normalize(q,q),s.cross(V,G,z),i[4*u]=q[0],i[4*u+1]=q[1],i[4*u+2]=q[2],i[4*u+3]=0>s.dot(V,o[u])?-1:1}},isUniqueVertex:function(){return this.isUseFace()?this.getVertexNumber()===this.faces.length:!0},generateUniqueVertex:function(){for(var t=[],e=0,r=this.getVertexNumber();r>e;e++)t[e]=0;for(var i=this.getVertexNumber(),a=this.attributes,n=this.faces,s=this.getEnabledAttributes(),o=0;s.length>o;o++){for(var u=s[o],h=new Float32Array(this.faces.length*a[u].size),r=a[u].value.length,e=0;r>e;e++)h[e]=a[u].value[e];a[u].value=h}for(var e=0;n.length>e;e++){var c=n[e];if(t[c]>0){for(var o=0;s.length>o;o++)for(var u=s[o],l=a[u].value,_=a[u].size,f=0;_>f;f++)l[i*_+f]=l[c*_+f];n[e]=i,i++}t[c]++}},generateBarycentric:function(){this.isUniqueVertex()||this.generateUniqueVertex();var t=this.attributes.barycentric.value;if(!t||t.length!==3*this.faces.length){t=this.attributes.barycentric.value=new Float32Array(3*this.faces.length);for(var e=0;this.faces.length>e;)for(var r=0;3>r;r++){var i=this.faces[e++];t[i+r]=1}}},convertToDynamic:function(t){for(var e=0;this.faces.length>e;e+=3)t.faces.push(this.face.subarray(e,e+3));var i=this.getEnabledAttributes();for(var a in i){var n=i[a],s=t.attributes[a];s||(s=t.attributes[a]={type:n.type,size:n.size,value:[]},n.semantic&&(s.semantic=n.semantic));for(var e=0;n.value.length>e;e+=n.size)1===n.size?s.value.push(n.array[e]):s.value.push(n.subarray(e,e+n.size))}return this.boundingBox&&(t.boundingBox=new r,t.boundingBox.min.copy(this.boundingBox.min),t.boundingBox.max.copy(this.boundingBox.max)),t},applyTransform:function(t){this.boundingBox&&this.boundingBox.applyTransform(t);var e=this.attributes.position.value,r=this.attributes.normal.value,i=this.attributes.tangent.value;t=t._array;var a=n.create();n.invert(a,t),n.transpose(a,a),s.forEach(e,3,0,null,s.transformMat4,t),r&&s.forEach(r,3,0,null,s.transformMat4,a),i&&s.forEach(i,4,0,null,s.transformMat4,a)},dispose:function(t){this._cache.use(t.__GLID__);var e=this._cache.get("chunks");if(e)for(var r=0;e.length>r;r++)for(var i=e[r],a=0;i.attributeBuffers.length>a;a++){var n=i.attributeBuffers[a];t.deleteBuffer(n.buffer)}this._cache.deleteContext(t.__GLID__)}});return o}),define("qtek/core/LinkedList",["require"],function(){"use strict";var t=function(){this.head=null,this.tail=null,this._length=0};return t.prototype.insert=function(e){var r=new t.Entry(e);return this.insertEntry(r),r},t.prototype.insertAt=function(e,r){if(!(0>e)){for(var i=this.head,a=0;i&&a!=e;)i=i.next,a++;if(i){var n=new t.Entry(r),s=i.prev;s.next=n,n.prev=s,n.next=i,i.prev=n}else this.insert(r)}},t.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,this._length++},t.prototype.remove=function(t){var e=t.prev,r=t.next;e?e.next=r:this.head=r,r?r.prev=e:this.tail=e,t.next=t.prev=null,this._length--},t.prototype.removeAt=function(t){if(!(0>t)){for(var e=this.head,r=0;e&&r!=t;)e=e.next,r++;return e?(this.remove(e),e.value):void 0}},t.prototype.getHead=function(){return this.head?this.head.value:void 0},t.prototype.getTail=function(){return this.tail?this.tail.value:void 0},t.prototype.getAt=function(t){if(!(0>t)){for(var e=this.head,r=0;e&&r!=t;)e=e.next,r++;return e.value}},t.prototype.indexOf=function(t){for(var e=this.head,r=0;e;){if(e.value===t)return r;e=e.next,r++}},t.prototype.length=function(){return this._length},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.forEach=function(t,e){for(var r=this.head,i=0,a=e!==void 0;r;)a?t.call(e,r.value,i):t(r.value,i),r=r.next,i++},t.prototype.clear=function(){this.tail=this.head=null,this._length=0},t.Entry=function(t){this.value=t,this.next=null,this.prev=null},t}),define("echarts-x/entity/marker/Base",["require"],function(){var t=function(t){this.chart=t};return t.prototype.setSeries=function(){},t.prototype.clear=function(){},t.prototype.onframe=function(){},t.prototype.getSceneNode=function(){},t.prototype.dispose=function(){var t=this.chart.baseLayer.renderer;t.dispose(this.getSceneNode(),!0,!0)},t}),define("echarts-x/util/geometry/Lines",["require","qtek/DynamicGeometry","qtek/Geometry","qtek/math/Vector3","qtek/dep/glmatrix"],function(t){var e=t("qtek/DynamicGeometry"),r=t("qtek/Geometry");t("qtek/math/Vector3");var i=t("qtek/dep/glmatrix").vec3,a=e.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearLines:function(){this.attributes.position.value.length=0,this.attributes.color.value.length=0},addLine:function(t,e,r){this.attributes.position.value.push(t._array,e._array),this.attributes.color.value.push(r,r)},addCubicCurve:function(t,e,r,a,n){t=t._array,e=e._array,r=r._array,a=a._array;for(var s=t[0],o=t[1],u=t[2],h=e[0],c=e[1],l=e[2],_=r[0],f=r[1],d=r[2],m=a[0],y=a[1],p=a[2],v=i.dist(t,e)+i.len(r,e)+i.len(a,r),g=15*(1/(v+1)),E=g*g,T=E*g,b=3*g,x=3*E,R=6*E,A=6*T,S=s-2*h+_,N=o-2*c+f,I=u-2*l+d,M=3*(h-_)-s+m,P=3*(c-f)-o+y,L=3*(l-d)-u+p,w=s,O=o,k=u,C=(h-s)*b+S*x+M*T,D=(c-o)*b+N*x+P*T,B=(l-u)*b+I*x+L*T,U=S*R+M*A,F=N*R+P*A,q=I*R+L*A,V=M*A,G=P*A,z=L*A,W=this.attributes.position.value,X=this.attributes.color.value,H=W.length,v=0,j=0;1+g>j;)v>1&&(W.push(W[H+v-1]),X.push(X[H+v-1]),v++),W.push(i.fromValues(w,O,k)),X.push(n),v++,w+=C,O+=D,k+=B,C+=U,D+=F,B+=q,U+=V,F+=G,q+=z,j+=g}});return a}),define("echarts-x/util/geometry/CurveAnimatingPoints",["require","qtek/DynamicGeometry","qtek/Geometry"],function(t){var e=t("qtek/DynamicGeometry"),r=t("qtek/Geometry"),i=r.Attribute,a=e.derive(function(){return{attributes:{p0:new i("p0","float",3,"",!0),p1:new i("p1","float",3,"",!0),p2:new i("p2","float",3,"",!0),p3:new i("p3","float",3,"",!0),offset:new i("offset","float",1,"",!0),size:new i("size","float",1,"",!0),color:new i("color","float",4,"COLOR",!0)},mainAttribute:"p0"}},{clearPoints:function(){var t=this.attributes;t.p0.value.length=0,t.p1.value.length=0,t.p2.value.length=0,t.p3.value.length=0,t.offset.value.length=0,t.size.value.length=0,t.color.value.length=0},addPoint:function(t,e,r,i,a){for(var n=this.attributes,s=Math.random(),o=0;15>o;o++)n.p0.value.push(t._array),n.p1.value.push(e._array),n.p2.value.push(r._array),n.p3.value.push(i._array),n.offset.value.push(s),n.size.value.push(o/15),n.color.value.push(a),s+=.004}});return a}),define("echarts-x/util/geometry/Bars",["require","qtek/DynamicGeometry","qtek/Geometry","qtek/geometry/Cube","qtek/math/Matrix4","qtek/math/Vector3","qtek/dep/glmatrix"],function(t){var e=t("qtek/DynamicGeometry");t("qtek/Geometry"),t("qtek/geometry/Cube");var r=t("qtek/math/Matrix4"),i=t("qtek/math/Vector3"),a=t("qtek/dep/glmatrix"),n=a.vec3,s=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,-2],[1,-1,-2],[1,1,-2],[-1,1,-2]],o=[[1,5,6],[1,6,2],[0,3,7],[0,7,4],[3,2,7],[2,6,7],[1,4,5],[1,0,4],[4,6,5],[4,7,6]],u=e.derive(function(){return{_barMat:new r,_barScaleVec:new i}},{clearBars:function(){this.attributes.position.value.length=0,this.attributes.color.value.length=0,this.faces.length=0},addBar:function(t,e,a,u){this._cubeGeometry;var h=this._barMat,c=this._barScaleVec,l=i.dist(t,e);if(!(0>=l)){i.set(c,.5*a,.5*a,.5*l),r.identity(h),r.lookAt(h,t,e,i.UP),r.invert(h,h),r.scale(h,h,c);for(var _=this.getVertexNumber(),f=0;o.length>f;f++){var d=n.clone(o[f]);d[0]+=_,d[1]+=_,d[2]+=_,this.faces.push(d)}for(var f=0;s.length>f;f++){var m=n.clone(s[f]);n.transformMat4(m,m,h._array),this.attributes.position.value.push(m),this.attributes.color.value.push(u)}}}});return u}),define("qtek/geometry/Cube",["require","../DynamicGeometry","./Plane","../math/Matrix4","../math/Vector3","../math/BoundingBox"],function(t){"use strict";function e(t,e,r){o.identity();var s=new i({widthSegments:e,heightSegments:r});switch(t){case"px":a.translate(o,o,n.POSITIVE_X),a.rotateY(o,o,Math.PI/2);break;case"nx":a.translate(o,o,n.NEGATIVE_X),a.rotateY(o,o,-Math.PI/2);break;case"py":a.translate(o,o,n.POSITIVE_Y),a.rotateX(o,o,-Math.PI/2);break;case"ny":a.translate(o,o,n.NEGATIVE_Y),a.rotateX(o,o,Math.PI/2);break;case"pz":a.translate(o,o,n.POSITIVE_Z);break;case"nz":a.translate(o,o,n.NEGATIVE_Z),a.rotateY(o,o,Math.PI)}return s.applyTransform(o),s}var r=t("../DynamicGeometry"),i=t("./Plane"),a=t("../math/Matrix4"),n=t("../math/Vector3"),s=t("../math/BoundingBox"),o=new a,u=r.derive({widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){this.faces.length=0,this.attributes.position.value.length=0,this.attributes.texcoord0.value.length=0,this.attributes.normal.value.length=0;var t={px:e("px",this.depthSegments,this.heightSegments),nx:e("nx",this.depthSegments,this.heightSegments),py:e("py",this.widthSegments,this.depthSegments),ny:e("ny",this.widthSegments,this.depthSegments),pz:e("pz",this.widthSegments,this.heightSegments),nz:e("nz",this.widthSegments,this.heightSegments)},r=0,i=["position","texcoord0","normal"];for(var a in t){for(var n=0;i.length>n;n++)for(var o=i[n],u=t[a].attributes[o].value,h=0;u.length>h;h++){var c=u[h];this.inside&&"normal"===o&&(c[0]=-c[0],c[1]=-c[1],c[2]=-c[2]),this.attributes[o].value.push(c)}for(var l=t[a],h=0;l.faces.length>h;h++){var _=l.faces[h];this.faces.push([_[0]+r,_[1]+r,_[2]+r])}r+=t[a].getVertexNumber()}this.boundingBox=new s,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});return u}),define("qtek/geometry/Plane",["require","../DynamicGeometry","../math/BoundingBox"],function(t){"use strict";var e=t("../DynamicGeometry"),r=t("../math/BoundingBox"),i=e.derive({widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){var t=this.heightSegments,e=this.widthSegments,i=this.attributes.position.value,a=this.attributes.texcoord0.value,n=this.attributes.normal.value,s=this.faces;i.length=0,a.length=0,n.length=0,s.length=0;for(var o=0;t>=o;o++)for(var u=o/t,h=0;e>=h;h++){var c=h/e;if(i.push([2*c-1,2*u-1,0]),a&&a.push([c,u]),n&&n.push([0,0,1]),e>h&&t>o){var l=h+o*(e+1);s.push([l,l+1,l+e+1]),s.push([l+e+1,l+1,l+e+2])}}this.boundingBox=new r,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}});return i}),define("echarts-x/surface/TextureAtlasSurface",["require","qtek/Texture2D","./ZRenderSurface"],function(t){t("qtek/Texture2D");var e=t("./ZRenderSurface"),r=function(t,r,i){this.zr=t,this._x=0,this._y=0,this._width=r||1024,this._height=i||1024,this._rowHeight=0,this._coords={},this._zrenderSurface=new e(r,i),this._zrenderSurface.onrefresh=function(){t.refreshNextFrame()}};return r.prototype={clear:function(){this._x=0,this._y=0,this._rowHeight=0,this._zrenderSurface.clearElements(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._zrenderSurface.getTexture()},resize:function(t,e){this._zrenderSurface.resize(t,e)},addShape:function(t,e,r){this._fitShape(t,e,r);var i=this._x,a=this._y;if(i+e>this._width&&a+this._rowHeight>this._height)return null;i+e>this._width&&(i=this._x=0,a+=this._rowHeight,this._y=a,this._rowHeight=0),this._x+=e,this._rowHeight=Math.max(this._rowHeight,r),t.position[0]+=i,t.position[1]+=a,this._zrenderSurface.addElement(t);var n=[[i/this._width,a/this._height],[(i+e)/this._width,(a+r)/this._height]];return this._coords[t.id]=n,n},refresh:function(){this._zrenderSurface.refresh()},_fitShape:function(t,e,r){var i=t.getRect(t.style),a=t.style.lineWidth||0,n=t.style.shadowBlur||0,s=a+n;i.x-=s,i.y-=s,i.width+=2*s,i.height+=2*s;var o=e/i.width,u=r/i.height;i.x,i.y,t.position=[-i.x*o,-i.y*u],t.scale=[o,u],t.updateTransform()},getImageCoords:function(t){return this._coords[t]}},r}),define("echarts-x/util/geometry/Sprites",["require","qtek/DynamicGeometry","qtek/math/Matrix4","qtek/math/Vector3","qtek/dep/glmatrix"],function(t){var e=t("qtek/DynamicGeometry");t("qtek/math/Matrix4"),t("qtek/math/Vector3");var r=t("qtek/dep/glmatrix").vec3,i=t("qtek/dep/glmatrix").vec2,a=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]],n=[[0,1,2],[0,2,3]],s=e.derive({},{clearSprites:function(){var t=this.attributes;t.position.value.length=0,t.texcoord0.value.length=0},addSprite:function(t,e){for(var s=this.getVertexNumber(),o=0;n.length>o;o++){var u=Array.prototype.slice.call(n[o]);u[0]+=s,u[1]+=s,u[2]+=s,this.faces.push(u)}for(var o=0;a.length>o;o++){var h=r.clone(a[o]);r.transformMat4(h,h,t._array),this.attributes.position.value.push(h)}var c=this.attributes.texcoord0.value,l=i.fromValues;c.push(l(e[0][0],e[1][1])),c.push(l(e[1][0],e[1][1])),c.push(l(e[1][0],e[0][1])),c.push(l(e[0][0],e[0][1]))}});return s}),define("echarts-x/util/sprite",["require"],function(){function t(t,e,r){var i=e||document.createElement("canvas");i.width=t,i.height=t;var a=i.getContext("2d");return r&&r(a),i}var e={makeSpriteFromShape:function(e,r,i){var a=r.getRect(r.style),n=r.style.lineWidth||0,s=r.style.shadowBlur||0,o=n+s;a.x-=o,a.y-=o,a.width+=2*o,a.height+=2*o;var u=e/a.width,h=e/a.height;return a.x,a.y,r.position=[-a.x*u,-a.y*h],r.scale=[u,h],r.updateTransform(),t(e,i,function(t){r.brush(t)})},makeSimpleSprite:function(e,r){return t(e,r,function(t){var r=e/2;t.beginPath(),t.arc(r,r,60,0,2*Math.PI,!1),t.closePath();var i=t.createRadialGradient(r,r,0,r,r,r);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=i,t.fill()})}};return e}),define("echarts-x/util/geometry/Points",["require","qtek/DynamicGeometry","qtek/Geometry"],function(t){var e=t("qtek/DynamicGeometry"),r=t("qtek/Geometry"),i=e.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),size:new r.Attribute("size","float",1,"",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearPoints:function(){var t=this.attributes;t.position.value.length=0,t.color.value.length=0,t.size.value.length=0},addPoint:function(t,e,r){var i=this.attributes;i.position.value.push(t._array),i.color.value.push(e),i.size.value.push(r)}});return i}),define("echarts-x/util/geometry/AnimatingPoints",["require","qtek/DynamicGeometry","qtek/Geometry"],function(t){var e=t("qtek/DynamicGeometry"),r=t("qtek/Geometry"),i=e.derive(function(){return{attributes:{position:new r.Attribute("position","float",3,"POSITION",!0),size:new r.Attribute("size","float",1,"",!0),delay:new r.Attribute("delay","float",1,"",!0),color:new r.Attribute("color","float",4,"COLOR",!0)}}},{clearPoints:function(){var t=this.attributes;t.position.value.length=0,t.color.value.length=0,t.size.value.length=0,t.delay.value.length=0},addPoint:function(t,e,r,i){var a=this.attributes;a.position.value.push(t._array),a.color.value.push(e),a.size.value.push(r),a.delay.value.push(i)}});return i}),define("qtek/compositor/Pass",["require","../core/Base","../camera/Orthographic","../geometry/Plane","../Shader","../Material","../Mesh","../core/glinfo","../core/glenum","../shader/source/compositor/vertex.essl"],function(t){"use strict";var e=t("../core/Base"),r=t("../camera/Orthographic"),i=t("../geometry/Plane"),a=t("../Shader"),n=t("../Material"),s=t("../Mesh"),o=t("../core/glinfo"),u=t("../core/glenum");a["import"](t("../shader/source/compositor/vertex.essl"));var h=new i,c=new s({geometry:h}),l=new r,_=e.derive(function(){return{fragment:"",outputs:null,material:null}},function(){var t=new a({vertex:a.source("buildin.compositor.vertex"),fragment:this.fragment}),e=new n({shader:t});t.enableTexturesAll(),this.material=e},{setUniform:function(t,e){var r=this.material.uniforms[t];r&&(r.value=e)},getUniform:function(t){var e=this.material.uniforms[t];return e?e.value:void 0},attachOutput:function(t,e){this.outputs||(this.outputs={}),e=e||u.COLOR_ATTACHMENT0,this.outputs[e]=t},detachOutput:function(t){for(var e in this.outputs)this.outputs[e]===t&&(this.outputs[e]=null)},bind:function(t,e){if(this.outputs)for(var r in this.outputs){var i=this.outputs[r];i&&e.attach(t.gl,i,r)}e&&e.bind(t)},unbind:function(t,e){e.unbind(t)},render:function(t,e){var r=t.gl;if(c.material=this.material,e){this.bind(t,e);var i=o.getExtension(r,"EXT_draw_buffers");if(i&&this.outputs){var a=[];for(var n in this.outputs)n=+n,n>=r.COLOR_ATTACHMENT0&&r.COLOR_ATTACHMENT0+8>=n&&a.push(n);i.drawBuffersEXT(a)}}this.trigger("beforerender",this,t),r.disable(r.BLEND),r.clear(r.DEPTH_BUFFER_BIT),t.renderQueue([c],l),this.trigger("afterrender",this,t),e&&this.unbind(t,e)}});return _}),define("qtek/FrameBuffer",["require","./core/Base","./TextureCube","./core/glinfo","./core/glenum","./core/Cache"],function(t){"use strict";var e=t("./core/Base"),r=t("./TextureCube"),i=t("./core/glinfo"),a=t("./core/glenum"),n=t("./core/Cache"),s=e.derive({depthBuffer:!0,_attachedTextures:null,_width:0,_height:0,_depthTextureAttached:!1,_renderBufferWidth:0,_renderBufferHeight:0,_binded:!1},function(){this._cache=new n,this._attachedTextures={}},{resize:function(t,e){this._width=t,this._height=e},bind:function(t){var e=t.gl;if(this._binded||(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer(e)),this._binded=!0),this._cache.put("viewport",t.viewport),t.setViewport(0,0,this._width,this._height,1),this._cache.miss("renderbuffer")&&this.depthBuffer&&!this._depthTextureAttached&&this._cache.put("renderbuffer",e.createRenderbuffer()),!this._depthTextureAttached&&this.depthBuffer){var r=this._width,i=this._height,a=this._cache.get("renderbuffer");(r!==this._renderBufferWidth||i!==this._renderBufferHeight)&&(e.bindRenderbuffer(e.RENDERBUFFER,a),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r,i),this._renderBufferWidth=r,this._renderBufferHeight=i,e.bindRenderbuffer(e.RENDERBUFFER,null)),this._cache.get("renderbuffer_attached")||(e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,a),this._cache.put("renderbuffer_attached",!0))}},unbind:function(t){var e=t.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),this._binded=!1,this._cache.use(e.__GLID__);var i=this._cache.get("viewport");i&&t.setViewport(i.x,i.y,i.width,i.height);for(var a in this._attachedTextures){var n=this._attachedTextures[a];if(!n.NPOT&&n.useMipmap){var s=n instanceof r?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D;e.bindTexture(s,n.getWebGLTexture(e)),e.generateMipmap(s),e.bindTexture(s,null)}}},getFrameBuffer:function(t){return this._cache.use(t.__GLID__),this._cache.miss("framebuffer")&&this._cache.put("framebuffer",t.createFramebuffer()),this._cache.get("framebuffer")},attach:function(t,e,r,n,s){if(!e.width)throw Error("The texture attached to color buffer is not a valid.");if(this._binded||(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer(t)),this._binded=!0),this._width=e.width,this._height=e.height,r=r||t.COLOR_ATTACHMENT0,n=n||t.TEXTURE_2D,s=s||0,r===t.DEPTH_ATTACHMENT){var o=i.getExtension(t,"WEBGL_depth_texture");if(!o)return console.error(" Depth texture is not supported by the browser "),void 0;if(e.format!==a.DEPTH_COMPONENT)return console.error("The texture attached to depth buffer is not a valid."),void 0;this._cache.put("renderbuffer_attached",!1),this._depthTextureAttached=!0}this._attachedTextures[r]=e,t.framebufferTexture2D(t.FRAMEBUFFER,r,n,e.getWebGLTexture(t),s)},detach:function(){},dispose:function(t){this._cache.use(t.__GLID__);var e=this._cache.get("renderbuffer");e&&t.deleteRenderbuffer(e);var r=this._cache.get("framebuffer");r&&t.deleteFramebuffer(r),this._cache.deleteContext(t.__GLID__)}});return s.COLOR_ATTACHMENT0=a.COLOR_ATTACHMENT0,s.DEPTH_ATTACHMENT=a.DEPTH_ATTACHMENT,s.STENCIL_ATTACHMENT=a.STENCIL_ATTACHMENT,s.DEPTH_STENCIL_ATTACHMENT=a.DEPTH_STENCIL_ATTACHMENT,s}),define("qtek/shader/source/compositor/vertex.essl",function(){return"\n@export buildin.compositor.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    v_Texcoord = texcoord;\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n\n@end"
}),define("qtek/TextureCube",["require","./Texture","./core/glinfo","./core/glenum","./core/util"],function(t){function e(t){return"CANVAS"===t.nodeName||t.complete}var r=t("./Texture"),i=t("./core/glinfo"),a=t("./core/glenum"),n=t("./core/util"),s={px:"TEXTURE_CUBE_MAP_POSITIVE_X",py:"TEXTURE_CUBE_MAP_POSITIVE_Y",pz:"TEXTURE_CUBE_MAP_POSITIVE_Z",nx:"TEXTURE_CUBE_MAP_NEGATIVE_X",ny:"TEXTURE_CUBE_MAP_NEGATIVE_Y",nz:"TEXTURE_CUBE_MAP_NEGATIVE_Z"},o=r.derive(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null}}},{update:function(t){t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.beforeUpdate(t);var e=this.format,r=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.wrapT),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.minFilter);var n=i.getExtension(t,"EXT_texture_filter_anisotropic");if(n&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===r){var o=i.getExtension(t,"OES_texture_half_float");o||(r=a.FLOAT)}for(var u in this.image){var h=this.image[u];h?t.texImage2D(t[s[u]],0,e,e,r,h):t.texImage2D(t[s[u]],0,e,this.width,this.height,0,e,r,this.pixels[u])}!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP),t.bindTexture(t.TEXTURE_CUBE_MAP,null)},generateMipmap:function(t){t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP)},bind:function(t){t.bindTexture(t.TEXTURE_CUBE_MAP,this.getWebGLTexture(t))},unbind:function(t){t.bindTexture(t.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){function t(t){return t&0===t-1}return this.image.px?t(this.image.px.width)&&t(this.image.px.height):t(this.width)&&t(this.height)},isRenderable:function(){return this.image.px?e(this.image.px)&&e(this.image.nx)&&e(this.image.py)&&e(this.image.ny)&&e(this.image.pz)&&e(this.image.nz):this.width&&this.height},load:function(t){var e=0,r=this;return n.each(t,function(t,i){var a=new Image;a.onload=function(){e--,0===e&&(r.dirty(),r.trigger("success",r)),a.onload=null},a.onerror=function(){e--,a.onerror=null},e++,a.src=t,r.image[i]=a}),this}});return o}),define("zrender/shape/ShapeBundle",["require","./Base","../tool/util"],function(t){var e=t("./Base"),r=function(t){e.call(this,t)};return r.prototype={constructor:r,type:"shape-bundle",brush:function(t,e){var r=this.beforeBrush(t,e);t.beginPath();for(var i=0;r.shapeList.length>i;i++){var a=r.shapeList[i],n=a.style;e&&(n=a.getHighlightStyle(n,a.highlightStyle||{},a.brushTypeOnly)),a.buildPath(t,n)}switch(r.brushType){case"both":t.fill();case"stroke":r.lineWidth>0&&t.stroke();break;default:t.fill()}this.drawText(t,r,this.style),this.afterBrush(t)},getRect:function(t){if(t.__rect)return t.__rect;for(var e=Number.MAX_VALUE,r=Number.MIN_VALUE,i=Number.MAX_VALUE,a=Number.MIN_VALUE,n=0;t.shapeList.length>n;n++)var s=t.shapeList[n],o=s.getRect(s.style),e=Math.min(o.x,e),i=Math.min(o.y,i),r=Math.max(o.x+o.width,r),a=Math.max(o.y+o.height,a);return t.__rect={x:e,y:i,width:r-e,height:a-i},t.__rect},isCover:function(t,e){var r=this.getTansform(t,e);t=r[0],e=r[1];var i=this.style.__rect;if(i||(i=this.getRect(this.style)),t>=i.x&&i.x+i.width>=t&&e>=i.y&&i.y+i.height>=e)for(var a=0;this.style.shapeList.length>a;a++){var n=this.style.shapeList[a];if(n.isCover(t,e))return!0}return!1}},t("../tool/util").inherits(r,e),r});